\section{Introduction}

\href{https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/active-directory-compare-azure-ad-to-ad}{Compare Active Directory to Azure Active Directory}

\subsection{Integration with on-premises Active Directory}

In order to allow Active Directory users to use the same credentials in the on-premises environment and in the cloud, passwords hashes must be synchronized. There are 3 ways to perform synchronization in Azure AD:
\begin{itemize}
    \item 
        \href{https://learn.microsoft.com/fr-fr/azure/active-directory/hybrid/connect/whatis-phs}{Password Hash Synchronization (PHS)}.
    \item 
        i\href{https://learn.microsoft.com/fr-fr/azure/active-directory/hybrid/connect/how-to-connect-pta}{Pass-through Authentication (PTA)}.
    \item 
        Active Directory Federation Services (ADFS).
\end{itemize}

\subsection{AADConnect}
Azure AD Connect has to be installed on a server from the Active Directory forest. Password hashes of Active Directory users do not transit over the network. A hash of each password hash is being sent instead.

Two accounts are automatically created by Azure AD Connect:
\begin{itemize}
    \item 
        \verb+MSOL_deeb213ff4bb+ in the Active Directory.
    \item
        \verb+Sync_SYNC01_deeb213ff4bb+ in Azure AD.
\end{itemize}

\verb+SYNC01+ being the hostname of the on-premises server where Azure AD Connect is installed and \verb+deeb213ff4bb+, an id, which changes for each environment.

In order to perfom the synchronization, the two accounts require high privileges over both environments. In the second part of this article, a way to compromise an Active Directory domain configured with PHS is shown.

\href{https://learn.microsoft.com/fr-fr/azure/active-directory/hybrid/connect/reference-connect-accounts-permissions}{Azure AD Connect : Comptes et autorisations}


\subsection{Azure AD security features}

\subsubsection{Conditional access policies}

\subsubsection{Identity Protection}

\subsubsection{Security Defaults}

\subsubsection{Password protection for Active Directory}

\subsubsection{Logging}

\subsection{links}
\begin{itemize}
    \item 
        \href{https://www.synacktiv.com/publications/azure-ad-introduction-for-red-teamers}{Azure AD introduction for red teamers}
\end{itemize}
