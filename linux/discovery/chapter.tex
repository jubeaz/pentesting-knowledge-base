\chapter{Discovery (TA0007)}
Enumeration is the key to privilege escalation. Several helper scripts (such as
\href{https://github.com/rebootuser/LinEnum}{LinEnum}) exist to assist with
enumeration:
\begin{itemize}
    \item \href{https://github.com/carlospolop/PEASS-ng}{LinPeas-np}
    \item \href{https://github.com/rebootuser/LinEnum}{LinEnum}
    \item \href{https://github.com/mzet-/linux-exploit-suggester}{Linux Exploit
        Suggester}
    \item \href{https://github.com/diego-treitos/linux-smart-enumeration}{Linux Smart Enumeration}
    \item \href{https://github.com/linted/linuxprivchecker}{Linux Privilege
        Escalation Check}
\end{itemize}

Still, it is important to understand what pieces of information to look for and to be able to perform enumeration manually. 

\section{System Information Discovery (T1082)}
\begin{verbatim}
uname -a

cat /etc/lsb-release
\end{verbatim}

\section{Process (T1057) and services (T1007) Discovery}

\begin{verbatim}
ps aux | grep root
ps au
ps aux
systemctl status
ls -la /etc/cron.*
\end{verbatim}

\href{https://github.com/DominicBreuker/pspy}{pspy},  a command-line tool used
to view running processes without the need for root privileges. We can use it
to see commands run by other users, cron jobs, etc. It works by scanning
\href{https://man7.org/linux/man-pages/man5/procfs.5.html}{procfs}

\begin{verbatim}
# print process and file system events scan procfs every 1000ms
./pspy64 -pf -i 1000
\end{verbatim}

\section{Software (T1518) and Security Software (T1518.001) Discovery}

\begin{verbatim}

\end{verbatim}

\section{Account Discovery (T1087)}
\subsection{Current user}
\begin{verbatim}
sudo -l
cat /etc/group |grep $(whoami)
history
\end{verbatim}

\subsection{Logged in user}
\begin{verbatim}
\end{verbatim}

\subsection{Local accounts}
\begin{verbatim}
cat /etc/passwd
ls /home
\end{verbatim}

\section{Permission Groups Discovery (T1069)}
\begin{verbatim}
cat /etc/group
\end{verbatim}

\section{Password policy (T1201)}
\begin{verbatim}
ls /etc/pam.d
more /etc/security/limits.conf
\end{verbatim}

\section{System Network Configuration Discovery (T1016)}
\begin{verbatim}
\end{verbatim}

\section{Peripheral Device Discovery (T1120)}
\subsection{File Systems and Additional Drives}
\begin{verbatim}
lsblk
\end{verbatim}

\section{Misc}

\subsection{Find Writable Directories / files}
\begin{verbatim}
find / -path /proc -prune -o -type d -perm -o+w 2>/dev/null
find / -path /proc -prune -o -type f -perm -o+w 2>/dev/null
\end{verbatim}


\subsection{Find Files and Directories Owned By Group(s)}

\begin{verbatim}
find / -group GROUPNAME
\end{verbatim}



\subsection{Find SUID/GUID}
\begin{verbatim}
find / -user root -perm -4000 -exec ls -ldb {} \; 2>/dev/null
find / -user root -perm -6000 -exec ls -ldb {} \; 2>/dev/null
\end{verbatim}


\subsection{read audit log}
\begin{verbatim}
aureport
aureport --tty | less
\end{verbatim}
