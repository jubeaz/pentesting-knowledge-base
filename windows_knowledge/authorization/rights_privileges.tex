
\section{Rights and Privileges}

Access rights and privileges are two important topics in AD. 

\textbf{Rights} deal with permissions to access an object such as a file.

\textbf{Privileges} grant a user permission to perform an action such as run a program, shut down a system, reset passwords, etc. 

Rights are typically assigned to users or groups and deal with
permissions to access an object such as a file.


Privileges can be assigned individually to users or conferred upon
them via built-in or custom group membership.
Windows computers have a concept called User Rights Assignment, which, while
referred to as rights, are actually types of privileges granted to a user.

This Microsoft article on
\href{https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/user-rights-assignment}{User
Rights Assignment} provides a detailed
explanation of each of the user rights that can be set in Windows as well as
security considerations applicable to each right.


Privileges are configured in the \emph{local security policy} or a \emph{domain
Group Policy} object. 

Some rights are only available to administrative users and can only be
listed/leveraged when running an elevated cmd or PowerShell session. These
concepts of elevated rights and User Account Control (UAC)~\ref{windows_knowledge:fundamentals:security:uac} are security features introduced with Windows Vista to default to restricting applications from running with full permissions unless necessary. 

\subsection{SeNetworkLogonRight}
\begin{itemize}
    \item Setting name:
        \href{https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/access-this-computer-from-the-network}{Access
        this computer from the network}
    \item Standard assignment: Administrators, Authenticated Users 	
    \item Description: 	Determines which users can connect to the device from the network. This is required by network protocols such as SMB, NetBIOS, CIFS, and COM+.

\end{itemize}
\subsection{SeRemoteInteractiveLogonRight}
\begin{itemize}
    \item Setting name:
        \href{https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/allow-log-on-through-remote-desktop-services}{Allow
        log on through Remote Desktop Services}
    \item Standard assignment: 	Administrators, Remote Desktop Users 
    \item Description: 	This policy setting determines which users or groups can access the login screen of a remote device through a Remote Desktop Services connection. A user can establish a Remote Desktop Services connection to a particular server but not be able to log on to the console of that same server.
\end{itemize}

\subsection{SeBackupPrivilege}
\begin{itemize}
    \item Setting name:
        \href{https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/back-up-files-and-directories}{Back
        up files and directories}
    \item Standard assignment:	Administrators
    \item Description:  	This user right determines which users can bypass file and directory, registry, and other persistent object permissions for the purposes of backing up the system.
    \item Attacker Tradecraft: Collection
\end{itemize}

\subsection{SeSecurityPrivilege} 
\begin{itemize}
    \item Setting name:
        \href{https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/manage-auditing-and-security-log}{Manage
        auditing and security log}
    \item Standard assignment: 	Administrators 
    \item Description: 	This policy setting determines which users can specify object access audit options for individual resources such as files, Active Directory objects, and registry keys. These objects specify their system access control lists (SACL). A user assigned this user right can also view and clear the Security log in Event Viewer.
\end{itemize}

\subsection{SeTakeOwnershipPrivilege}
\begin{itemize}
    \item Setting name:
        \href{https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/take-ownership-of-files-or-other-objects}{Take
        ownership of files or other objects}
    \item Standard assignment: 	Administrators
    \item Description:  	This policy setting determines which users can take
        ownership of any securable object in the device, including Active
        Directory objects, NTFS files and folders, printers, registry keys,
        services, processes, and threads. This privilege assigns
        \href{https://docs.microsoft.com/en-us/windows/win32/secauthz/standard-access-rights}{WRITE\_OWNER} rights over an object, meaning the user can change the owner within the object's security descriptor. 
    \item Attacker Tradecraft: Persistence; Defense Evasion; Collection
\end{itemize}

\subsection{SeDebugPrivilege}
\begin{itemize}
    \item Setting name:
        \href{https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/debug-programs}{Debug
        programs}
    \item Standard assignment:	Administrators
    \item Description:  	This policy setting determines which users can attach to or open any process, even a process they do not own. Developers who are debugging their applications do not need this user right. Developers who are debugging new system components need this user right. This user right provides access to sensitive and critical operating system components.
    \item Attacker Tradecraft: Privilege Escalation; Defense Evasion; Credential Access
\end{itemize}

\subsection{SeImpersonatePrivilege}
\begin{itemize}
    \item Setting name:
        \href{https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/impersonate-a-client-after-authentication}{Impersonate
        a client after authentication}
    \item Standard assignment: 	Administrators, Local Service, Network Service, Service 
    \item Description: 	This policy setting determines which programs are allowed to impersonate a user or another specified account and act on behalf of the user.
\end{itemize}

\subsection{SeLoadDriverPrivilege}
\begin{itemize}
    \item Setting name:
        \href{https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/load-and-unload-device-drivers}{Load
        and unload device drivers }
    \item Standard assignment:	Administrators 
    \item Description: 	This policy setting determines which users can dynamically load and unload device drivers. This user right is not required if a signed driver for the new hardware already exists in the driver.cab file on the device. Device drivers run as highly privileged code.
    \item Attacker Tradecraft: Persistence; Defense Evasion
\end{itemize}


\subsection{SeRestorePrivilege}
\begin{itemize}
    \item Setting name:
        \href{https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/restore-files-and-directories}{Restore
        files and directories}
    \item Standard assignment:	Administrators 
    \item Description: 	This security setting determines which users can bypass file, directory, registry, and other persistent object permissions when they restore backed up files and directories. It determines which users can set valid security principals as the owner of an object.
\end{itemize}

\subsection{SeCreateTokenPrivilege}
\begin{itemize}
    \item Description: Required to create a primary token.
    \item Attacker Tradecraft: Privilege Escalation
\end{itemize}

\subsection{SeTcbPrivilege}
\begin{itemize}
    \item Description: This privilege identifies its holder as part of the trusted computer base. Some trusted protected subsystems are granted this privilege.
    \item Attacker Tradecraft: Privilege Escalation
\end{itemize}
