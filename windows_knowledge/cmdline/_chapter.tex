\chapter{cmd and Powershell}
\section{cmd}
The
\href{https://download.microsoft.com/download/5/8/9/58911986-D4AD-4695-BF63-F734CD4DF8F2/ws-commands.pdf}{Windows
Command Reference} from Microsoft is a comprehensive A-Z command reference
which includes an overview, usage examples, and command syntax for most Windows
commands, and familiarity with it is recommended.

\verb+help <command name>+ 

\section{PowerShell}
\subsection{Cmdlets}
PowerShell utilizes
\href{https://docs.microsoft.com/en-us/powershell/scripting/developer/cmdlet/cmdlet-overview?view=powershell-7}{cmdlets},
which are small single-function tools built into the shell. There are more than
100 core cmdlets, and many additional ones have been written, or we can author
our own to perform more complex tasks. PowerShell also supports both simple and
complex scripts used for system administration tasks, automation, and more.

Cmdlets are in the form of \verb+Verb-Noun+

\subsection{Aliases}

Many cmdlets in PowerShell also have aliases.
\begin{verbatim}
get-alias

New-Alias -Name "Show-Files" Get-ChildItem
\end{verbatim}

\subsection{Help}
\begin{verbatim}
 Get-Help <cmdlet-name> -Online 

 Update-Help
 Get-Help Get-AppPackage
\end{verbatim}

\subsection{Running Scripts}
The PowerShell ISE (Integrated Scripting Environment) allows users to write
PowerShell scripts on the fly. It also has an autocomplete/lookup function for
PowerShell commands. The PowerShell ISE allows us to write and run scripts in
the same console, which allows for quick debugging.

\begin{verbatim}
.\PowerView.ps1;Get-LocalGroup |fl

Import-Module .\PowerView.ps1

# list all loaded modules and their associated commands
Get-Module | select Name,ExportedCommands | fl

\end{verbatim}

\subsection{Execution Policy}
The possible policies are:

\begin{tabularx}{\linewidth}{|lX|}
    \hline
Policy &	Description\\
    \hline
AllSigned &	All scripts can run, but a trusted publisher must sign scripts and
configuration files. This includes both remote and local scripts. We receive a
prompt before running scripts signed by publishers that we have not yet listed
as either trusted or untrusted.\\
    \hline
Bypass &	No scripts or configuration files are blocked, and the user
receives no warnings or prompts.\\
    \hline
Default &	This sets the default execution policy, \emph{Restricted} for
Windows desktop machines and \emph{RemoteSigned} for Windows servers.\\
    \hline
RemoteSigned &	Scripts can run but requires a digital signature on scripts
that are downloaded from the internet. Digital signatures are not required for
scripts that are written locally.\\
    \hline
Restricted &	This allows individual commands but does not allow scripts to
be run. All script file types, including configuration files (.ps1xml), module
script files (.psm1), and PowerShell profiles (.ps1) are blocked.\\
    \hline
Undefined &	No execution policy is set for the current scope. If the execution
policy for ALL scopes is set to undefined, then the default execution policy of
Restricted will be used.\\
    \hline
Unrestricted &	This is the default execution policy for non-Windows computers,
and it cannot be changed. This policy allows for unsigned scripts to be run but
warns the user before running scripts that are not from the local intranet
zone.\\
    \hline
\end{tabularx}


\verb+Get-ExecutionPolicy -List+

The execution policy is not meant to be a security control that restricts user
actions. A user can easily bypass the policy by either typing the script
contents directly into the PowerShell window, downloading and invoking the
script, or specifying the script as an encoded command. It can also be bypassed
by adjusting the execution policy (if the user has the proper rights) or
setting the execution policy for the current process scope (which can be done
by almost any user as it does not require a configuration change and will only
be set for the duration of the user's session).


\verb+Set-ExecutionPolicy Bypass -Scope Process+
