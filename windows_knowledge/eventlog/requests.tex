
\section{Some requests}

PowerShell Base64 Command Lines:
\begin{verbatim}
Get-WinEvent -FilterHashtable @{ LogName='Microsoft-Windows-PowerShell/Operational'; Id='4104';} | Where-object -Property Message -Match "[A-Za-z0-9+/=]{200}" | Format-List -Property Message

\end{verbatim}


Related to a session:
\begin{verbatim}
">*[EventData[Data[@Name='SubjectLogonId'] = '0x3E7']]
\end{verbatim}

get all event from security related to a session:
\begin{verbatim}
Get-WinEvent -FilterHashtable @{LogName="Security";ID=4624} | Select-Object -Property TimeCreated, Id, Message | Format-Table -AutoSize

$logonID = "0x3802EAB"
$events = Get-WinEvent -LogName Security | Where-Object { $_.Message -like "*$logonID*" }
$events | Select-Object -Property TimeCreated, Id, Message | Format-Table -AutoSize
\end{verbatim}



get all event from all eventlogs related to a session:
\begin{verbatim}
    $sessionId = "0x3e7" 
    $logNames = Get-WinEvent -ListLog *
    $relatedEvents = @()

    foreach ($logName in $logNames.LogName) {
        try {
            $events = Get-WinEvent -LogName $logName | Where-Object { $_.Message -like "*0x387EBDC*" }
            if ($events) {
                $relatedEvents += $events
            }
        } catch {
            Write-Warning "Unable to access log: $logName"
        }
    }

$relatedEvents | Format-Table -AutoSize | Out-File "C:\path\to\output\session_related_events.txt"
\end{verbatim}

