\section{Theft attacks}

\subsection{THEFT1: Exporting Certificates Using the Crypto APIs}

\subsubsection{CertStealer (windows)}

\href{https://github.com/TheWover/CertStealer}{CertStealer}

\subsubsection{Mimikatz}

If the private key is non-exportable, CAPI and CNG will not allow extraction of
non-exportable certificates. Mimikatz’s \verb+crypto::capi+ and
\verb+crypto::cng+ commands can patch the CAPI and CNG to allow exportation of
private keys. \verb+crypto::capi+ patches CAPI in the current process whereas
\verb+crypto::cng+ requires patching lsass.exe’s memory

\begin{verbatim}
crypto::capi
crypto::certificates /export
\end{verbatim}


\subsection{THEFT2: User Certificate Theft via DPAPI}
Windows stores certificate private keys using DPAP
\subsection{THEFT3: Machine Certificate Theft via DPAPI}
\subsection{THEFT4: Finding Certificates Files}
\subsection{THEFT5: NTLM Creds via PKINIT}
