\section{Domain Trust (T1482)}
\label{mitre:t1482}

\subsection{domain trust}

tools:
\begin{itemize}
    \item LOL~\ref{tool:wlol:ad:get-ADTrust}
        \begin{verbatim}
        dsquery * -filter “(objectClass=trustedDomain)” -attr *
        \end{verbatim}
        
    \item ldapsearch:
        \begin{verbatim}
        ldapsearch -H ldap://test.local -b DC=test,DC=local "(objectclass=trusteddomain)"
        \end{verbatim}
        
    \item PowerView~\ref{tool:powerview:Get-DomainTrust}
    \item BloodHound~\ref{tool:bloodhound} \verb+-CollectionMethod trusts+ and \verb+-Domain <foreign.domain.fqdn>+ then \verb+Map Domain Trusts+
        analysis.
\end{itemize}

\subsection{domain trust bridges}

using bloodhound-python to enumerate all domains (setting in resolv.conf the domain and the nameserver). Then in \verb+Analysis > Dangerous Privileges+ there are \verb+User with Foreign Domain Group Membership+ and \verb+Groups with Foreigh Domain Group Membership+

\subsection{Data Enumeration Across Trusts With PowerView}

Get-Domain* function uses LDAP enumeration, meaning that we can pull said information from a domain that trusts us. This is done with the -Domain <domain.fqdn> parameter.

\begin{verbatim}
Get-DomainComputer -Domain <TARGET_DOMAIN>
Get-DomainUser -Domain <TARGET_DOMAIN>
...
\end{verbatim}

