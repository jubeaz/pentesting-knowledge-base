\section{Initial enumeration (without creds)}
\begin{tabularx}{\linewidth}{|l|X|}
    \hline
Data Point &	Description \\
    \hline
AD Users &	try to enumerate valid user accounts that can target for password
spraying.\\
    \hline
AD Joined Computers &	Key Computers include Domain Controllers, file servers,
SQL servers, web servers, Exchange mail servers, database servers, \ldots.\\
    \hline
Key Services &	Kerberos, NetBIOS, LDAP, DNS\\
    \hline
Vulnerable Hosts and Services &	Anything that can be a quick win. (.k.a an
easy host to exploit and gain a foothold)\\
    \hline
\end{tabularx}

\begin{enumerate}
        \item passive identification of any hosts in the network,
        \item active validation of the results to find out more about each host
            (what services are running, names, potential vulnerabilities,
            \ldots.).
        \item Once hosts have been identifyed, they can be probed, looking for
            any interesting data. 
        \item Analyze hopefully a set of credentials or a user account to
            target for a foothold onto a domain-joined host have been found.
\end{enumerate}

\subsection{Hosts enumeration}
\subsubsection{Passive enumeration}

Using tools:
\begin{itemize}
    \item wireshark~\ref{tool:wireshark}, 
    \item tcpdump~\ref{tool:tcpdump},
    \item \href{https://github.com/DanMcInerney/net-creds}{net-creds}
    \item \href{http://www.netminer.com/main/main-read.do}{netminer}
    \item \verb+pktmon.exe+ (on windows)
    \item Responder~\ref{tool:responder:analyze} in analyze 
\end{itemize}

\subsubsection{Active enumeration}

Using tools:
\begin{itemize}
    \item {\bf \href{https://fping.org/}{fping}}: \verb+fping -asgq+
        172.16.5.0/23+ (\verb+a+ show alive, \verb+s+ state, \verb+g+ generate
        list and \verb+q+ per-target result)
    \item nmap~\ref{tool:nmap:enumeration}
    \item nmap~\ref{tool:nmap} (\verb+-v -A -iL hosts.txt -oA enum+) \verb+A+
        is to violent.
\end{itemize}


\subsection{Identifying Potential Vulnerabilities}
The
\href{https://docs.microsoft.com/en-us/windows/win32/services/localsystem-account}{local
system} account \verb+NT AUTHORITY\SYSTEM+ is a built-in account in Windows
operating systems. It has the highest level of access in the OS and is used to
run most Windows services. It is also very common for third-party services to
run in the context of this account by default. A \verb+SYSTEM+ account on a
domain-joined host will be able to enumerate Active Directory by impersonating
the computer account, which is essentially just another kind of user account.
Having SYSTEM-level access within a domain environment is nearly equivalent to
having a domain user account.

There are several ways to gain SYSTEM-level access on a host, including but not limited to:
\begin{itemize}
    \item  Remote Windows exploits such as MS08-067, EternalBlue, or BlueKeep.
    \item  Abusing a service running in the context of the \verb+SYSTEM account+, or abusing the service account \verb+SeImpersonate+ privileges using \href{https://github.com/ohpe/juicy-potato}{Juicy
        Potato}. This type of attack is possible on older Windows OS' but not
        always possible with Windows Server 2019.
    \item  Local privilege escalation flaws in Windows operating systems such as the Windows 10 Task Scheduler 0-day.
    \item  Gaining admin access on a domain-joined host with a local account and using Psexec to launch a SYSTEM cmd window
\end{itemize}

By gaining SYSTEM-level access on a domain-joined host, you will be able to perform actions such as, but not limited to:

\begin{itemize}
        \item Enumerate the domain using built-in tools or offensive tools such as BloodHound and PowerView.
        \item Perform Kerberoasting / ASREPRoasting attacks within the same domain.
        \item Run tools such as Inveigh to gather Net-NTLMv2 hashes or perform SMB relay attacks.
        \item Perform token impersonation to hijack a privileged domain user account.
        \item Carry out ACL attacks.
\end{itemize}



