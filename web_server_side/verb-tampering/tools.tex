
\section{Automated tool}

\href{https://github.com/ShutdownRepo/httpmethods}{HTTP Methods Tester} can be
modified to add parameters to test

\begin{verbatim}
    parser.add_argument(
+        '-p',
+        '--params',
+        action="store",
+        default=None,
+        required=False,
+        dest='params',
+        help="Specify params (e.g., var=value&var2=value2)"
+    )
+

-def methods_from_http_options(console, options, proxies, headers, cookies):
+def methods_from_http_options(console, options, proxies, headers, cookies, params):

-def test_method(options, method, proxies, cookies, headers, results):
+def test_method(options, method, proxies, cookies, params, headers, results):
+    if (method in ['GET', 'PUT']):
+        print("Params " + method)
+    else:
+        print("data " + method)
     try:
-        r = requests.request(
-            method=method,
-            url=options.url,
-            verify=options.verify,  # this is to set the client to accept insecure servers
-            proxies=proxies,
-            cookies=cookies,
-            headers=headers,
-            allow_redirects=options.redirect,
-            stream=True,  # this is to prevent the download of huge files, focus on the request, not on the data
-        )
+        if (method in ['GET']):
+            r = requests.request(
+                method=method,
+                data=params,
+                params=params,
+                url=options.url,
+                verify=options.verify,  # this is to set the client to accept insecure servers
+                proxies=proxies,
+                cookies=cookies,
+                headers=headers,
+                allow_redirects=options.redirect,
+                stream=True,  # this is to prevent the download of huge files, focus on the request, not on the data
+            )
+        else:
+            r = requests.request(
+                method=method,
+                params=params,
+                data=params,
+                url=options.url,
+                verify=options.verify,  # this is to set the client to accept insecure servers
+                proxies=proxies,
+                cookies=cookies,
+                headers=headers,
+                allow_redirects=options.redirect,
+                stream=True,  # this is to prevent the download of huge files, focus on the request, not on the data
+            )


+
+    if options.params:
+        params = options.params
+    else:
+        params = {}



-    methods += methods_from_http_options(console, options, proxies, headers, cookies)
+    methods += methods_from_http_options(console, options, proxies, headers,
+            cookies, params)


-            tp.submit(test_method, options, method, proxies, cookies, headers, results)
+            tp.submit(test_method, options, method, proxies, cookies, params,
+                    headers,results)

\end{verbatim}
