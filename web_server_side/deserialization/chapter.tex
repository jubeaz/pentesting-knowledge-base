\chapter{Insecure deserialization}

\input{web_server_side/deserialization/intro}
\input{web_server_side/deserialization/attacks}
\input{web_server_side/deserialization/php}
\input{web_server_side/deserialization/python}
\input{web_server_side/deserialization/java}


\section{HMAC hardening and bypass}
in case serrialzed data are secured using HMAC the only way is to have access
to the sercets.

\section{tools}
\subsection{Online}

\begin{itemize}
    \item \href{https://www.functions-online.com/unserialize.html}{PHP
        unserializer/deserializer}
\end{itemize}


\subsection{Burp extensions}
\subsubsection{Hackvertor}
With Hackvertor, you can modify the serialized data as a string, and it will
automatically update the binary data, adjusting the offsets accordingly.

\subsection{PHPGGC}
\href{https://github.com/ambionics/phpggc}{PHPGGC} is a tool by Ambionics,
whose name stands for PHP Generic Gadget Chains.

\subsection{PEAS}
\href{https://github.com/j0lt-github/python-deserialization-attack-payload-generator}{PEAS}
is a tool which can generate Python deserialization payloads for Pickle,
JSONPickle, PyYAML and ruamel.yaml.

\verb+peas.py+ make use of \verb+subprocess.Popen+ to launch a system command
so in case this is blacklisted it must be edited to use another option sur as
\verb+os.system+
