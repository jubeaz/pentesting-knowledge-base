\part{misc}
\input{misc/wordlists/chapter.tex}
\input{misc/pivoting/chapter.tex}
\input{misc/file_transfert/chapter.tex}
\input{misc/misc/chapter.tex}

\chapter{Misc Windows}
\section{bitlocked VHD backup}

Here's the situation -- you're on a network and you find a Network Attached
Storage device with a share protected using a weak password.  You brute force
the password and once you login, you find a WindowsImageBackup directory which
houses the data from a Windows Server Backup.  When we view the contents, we're
interested in the files with the VHD or VHDX extension.  VHDX is essentially
the same as VHD but the size limit on VHDX was increased to 2TB.  That's
neither here nor there, what we really want is inside the file.


To mount the \verb+libguestfs+ package is requiered.

\begin{verbatim}
sudo guestmount --add VHD_FILE_PATH  --inspector --ro MOUNT_POINY -v
\end{verbatim}

if the disk is bitlocked the passphrase is requested by \verb+guestmount+. To
obtain if :
\begin{verbatim}
bitlocker2john -i Backup.vhd > backup.hashes
hashcat -m 22100 backup.hash  WORDLIST -o OUTPUT_FILE
\end{verbatim}


on windows only try to mount the \verb+vhd+ either there is a prompt to enter
the passphrase or an error. Then launch \verb+manage bitlocker+ and find the drive in
removable media.

