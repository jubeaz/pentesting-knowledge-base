\section{Password generation conform to strength policy}
\label{wordlist:passwd_regex_filter}

\subsection{Regular expressions for filtering passwords}
Examples of regular expressions that will be useful to us:
\begin{itemize}
 \item There must be one capital letter:
    \begin{verbatim}
    '.*[A-Z]{1,}.*'
    \end{verbatim}
 \item There must be two capital letters:
    \begin{verbatim}
    '.*[A-Z]{1,}.*[A-Z]{1,}.*'
    \end{verbatim}
 \item There must be three large letters:
    \begin{verbatim}
    '.*[A-Z]{1,}.*[A-Z]{1,}.*[A-Z]{1,}.*'
    \end{verbatim}
 \item There must be one small letter:
    \begin{verbatim}
    '.*[a-z]{1,}.*'
    \end{verbatim}
 \item There must be two small letters:
    \begin{verbatim}
    '.*[a-z]{1,}.*[a-z]{1,}.*'
    \end{verbatim}
 \item There must be three small letters:
    \begin{verbatim}
    '.*[a-z]{1,}.*[a-z]{1,}.*[a-z]{1,}.*'
    \end{verbatim}
 \item There must be one number:
    \begin{verbatim}
    '.*[0-9]{1,}.*'
    \end{verbatim}
 \item There are two numbers required:
    \begin{verbatim}
    '.*[0-9]{1,}.*[0-9]{1,}.*'
    \end{verbatim}
 \item There are three numbers required:
    \begin{verbatim}
    '.*[0-9]{1,}.*[0-9]{1,}.*[0-9]{1,}.*'
    \end{verbatim}
\end{itemize}

\verb+-r+
 \href{https://en.m.wikibooks.org/wiki/Regular_Expressions/POSIX-Extended_Regular_Expressions}{Extended
regular expression}

\begin{itemize}
    \item \verb+{n}+: previous expression match exactly $n$ times
    \item \verb+{n,}+:previous expression match at least $n$ times ($\geq n$)
    \item \verb+{,m}+:previous expression match at most $m$ times  ($ \leq m$)
    \item \verb+{n,m}+:previous expression match between $n$ and $m$ times
        included 

\end{itemize}
\verb+\{m,n\}+ Matches the preceding element at least \verb+m+ and not more
than \verb+n+ times. ( $ m \geq |prefix| < n$)
\verb+-i+: edit file in place
\begin{verbatim}
sed -r '/^.{,7}$/d' t            remove shorter or equal to 7
sed -r '/^.{7,}$/d' t            remove longuer longuer or equal to 7
sed -r '/[!-/:-@\[-`\{-~]+/!d'   remove no special chars
sed -r '/[0-9]+/!d' t            remove no numbers
\end{verbatim}

\begin{verbatim}
cat mut_password.list \
    | grep -E '.*[A-Z]{1,}.*' \
    | sed -r '/^.{,11}$/d' \
    | sed -r '/^.{13,}$/d' \
    | awk '{ print length(), $0 \
    | "sort -n" }' \
    |cut -f2 -d' ' 
\end{verbatim}


\subsection{Filtering wordlists}
\begin{verbatim}
cat ~/rockyou_clean.txt \
    | grep -E '.*[A-Z]{1,}.*[A-Z]{1,}.*' \
    | grep -E '.*[a-z]{1,}.*' \
    | grep -E '.*[0-9]{1,}.*' \
    > ~/rockyou_llud.dic
\end{verbatim}

\subsection{How to generate wordlists}
\begin{verbatim}
maskprocessor -1 ?l?u?d ?1?1?1?1?1?1?1?1 \
    | grep -E '.*[A-Z]{1,}.*[A-Z]{1,}.*' \
    | grep -E '.*[a-z]{1,}.*' \
    | grep -E '.*[0-9]{1,}.*' \
    > ~/rockyou_llud.dic
\end{verbatim}

Passing generated passwords to hashcat stdin:
\begin{verbatim}
maskprocessor -1 ?l?u?d ?1?1?1?1?1?1?1?1 \
    | grep -E '.*[A-Z]{1,}.*[A-Z]{1,}.*' \
    | grep -E '.*[a-z]{1,}.*' \
    | grep -E '.*[0-9]{1,}.*' \
    | hashcat -m 0 -a 0 ...
\end{verbatim}

\subsection{Using rule based}
See~\ref{tool:jtr:rule-exp-filter}

\url{https://miloserdov.org/?p=5477}

\url{https://hashcat.net/wiki/doku.php?id=rule_based_attack}

 

