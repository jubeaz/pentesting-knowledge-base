\section{generate passwords that match password strength policies}
\subsection{Regular expressions for filtering passwords}
Examples of regular expressions that will be useful to us:
\begin{itemize}
 \item There must be one capital letter:
    \begin{verbatim}
    '.*[A-Z]{1,}.*'
    \end{verbatim}
 \item There must be two capital letters:
    \begin{verbatim}
    '.*[A-Z]{1,}.*[A-Z]{1,}.*'
    \end{verbatim}
 \item There must be three large letters:
    \begin{verbatim}
    '.*[A-Z]{1,}.*[A-Z]{1,}.*[A-Z]{1,}.*'
    \end{verbatim}
 \item There must be one small letter:
    \begin{verbatim}
    '.*[a-z]{1,}.*'
    \end{verbatim}
 \item There must be two small letters:
    \begin{verbatim}
    '.*[a-z]{1,}.*[a-z]{1,}.*'
    \end{verbatim}
 \item There must be three small letters:
    \begin{verbatim}
    '.*[a-z]{1,}.*[a-z]{1,}.*[a-z]{1,}.*'
    \end{verbatim}
 \item There must be one number:
    \begin{verbatim}
    '.*[0-9]{1,}.*'
    \end{verbatim}
 \item There are two numbers required:
    \begin{verbatim}
    '.*[0-9]{1,}.*[0-9]{1,}.*'
    \end{verbatim}
 \item There are three numbers required:
    \begin{verbatim}
    '.*[0-9]{1,}.*[0-9]{1,}.*[0-9]{1,}.*'
    \end{verbatim}
\end{itemize}

\begin{verbatim}
sed -ri '/^.{,7}$/d' william.txt            \section{remove shorter than 8
sed -ri '/[!-/:-@\[-`\{-~]+/!d' william.txt \section{remove no special chars
sed -ri '/[0-9]+/!d' william.txt            \section{remove no numbers
\end{verbatim}


\subsection{Filtering wordlists}
\begin{verbatim}
cat ~/rockyou_clean.txt \
    | grep -E '.*[A-Z]{1,}.*[A-Z]{1,}.*' \
    | grep -E '.*[a-z]{1,}.*' \
    | grep -E '.*[0-9]{1,}.*' \
    > ~/rockyou_llud.dic
\end{verbatim}

\subsection{How to generate wordlists}
\begin{verbatim}
maskprocessor -1 ?l?u?d ?1?1?1?1?1?1?1?1 \
    | grep -E '.*[A-Z]{1,}.*[A-Z]{1,}.*' \
    | grep -E '.*[a-z]{1,}.*' \
    | grep -E '.*[0-9]{1,}.*' \
    > ~/rockyou_llud.dic
\end{verbatim}

Passing generated passwords to hashcat stdin:
\begin{verbatim}
maskprocessor -1 ?l?u?d ?1?1?1?1?1?1?1?1 \
    | grep -E '.*[A-Z]{1,}.*[A-Z]{1,}.*' \
    | grep -E '.*[a-z]{1,}.*' \
    | grep -E '.*[0-9]{1,}.*' \
    | hashcat -m 0 -a 0 ...
\end{verbatim}

\subsection{Using rule based}
\url{https://miloserdov.org/?p=5477}

\url{https://hashcat.net/wiki/doku.php?id=rule_based_attack}

\subsubsection{Selection of passwords that comply with a certain policy}
 For this we need two rules:
\begin{itemize}
    \item \verb+/?C+ : reject a word if it does not contain a character in class C.
    \item \verb+%N?C+ :  rejects a word if it does not contain at least N characters of class C. 
    \item \verb+>N+ : means to reject the word if it does not exceed N characters
\end{itemize}

This rule set rejects passwords that do not contain at least one of the characters: lowercase letter, uppercase letter, number, punctuation marks:
\begin{verbatim}
/?l /?u /?d /?p
\end{verbatim}

This second set of rules rejects passwords that do not contain at least one of the characters: lowercase letter, uppercase letter, number, special character.
\begin{verbatim}
/?l /?u /?d /?s
\end{verbatim}

Within one line, there is a logical \verb+AND+ applied, that is, all passwords that are missing at least one character class will be discarded.

But there is a logical \verb+OR+ between the lines, that is, all passwords that meet the criteria of the first line or the criteria of the second line will be skipped.

\begin{verbatim}
[List.Rules:StrongPass]
/?l /?u /?d /?p >7
/?l /?u /?d /?s >7
\end{verbatim}

\begin{verbatim}
john --rules=StrongPass --wordlist=rockyou.txt --stdout | wc -l
\end{verbatim}


