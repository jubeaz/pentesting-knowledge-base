\section{Mentalist}
\label{tool:mentalist}
\subsection*{concepts}

\subsubsection*{Chain}

Mentalist generates wordlists by linking together \emph{nodes}, which form a
\emph{chain}. The first node in a chain is always the Base Words node. When the chain is processed, each Base Word passes to the next node in the chain, which might modify the word, leave it the same or create more variations of it. Finally, the results are written to an output file as either the full wordlist or rules to generate the equivalent list.

\subsubsection*{Nodes}
There are 5 types of nodes. Each type has its own set of attributes, which can
be added in any combination. A node's attributes determine its function.
Furthermore, \emph{attributes within the same node are mutually exclusive from
each other}.

Some nodes may produce more than one output word for each input word. In such
cases, only the set of unique output words for a Base Word is passed on to the
next node. In other words, \emph{each node performs de-duplication on each base
word}.

\begin{tabular}{|l|l|}
 \hline
Type &	Description \\
 \hline
Base Words   &	Always the first node within the Mentalist chain. It provides
the root words, which are to be processed by each node as they pass down the
chain. \\
 \hline
Case         &	Changes the case of letters within the word. Each attribute
added to a Case node produces a different variation of the input word, except
for the No Case Change attribute which passes through the original word. \\
 \hline
Substitution & 	Replaces characters within the word. Like Case, each attribute
added to a Substitution node produces another output word, subject to
de-duplication. The No Substitution attribute gives the unmodified input word.
\\
 \hline
Append       & 	Append nodes add strings to the end of the input word. Most
Append attributes produce many variations of the input word. For example, the
Numbers: Small (0-100) attribute adds 101 output words for each input word. \\
 \hline
Prepend      & 	Prepend nodes add strings to the beginning of the input word.
Its attributes and functionality is otherwise identical to Append.  \\
 \hline
\end{tabular}

\subsubsection*{Attributes}
Each node has the ability to perform one or more actions on the input words.
These actions are specified in each node's attributes. \emph{Attributes within
the same node are mutually exclusive of each other }and, as a consequence, a node can have no duplicate attributes.  

\subsection*{Node attributes}
\subsubsection*{Base words}

\begin{tabular}{|l|l|}
 \hline
Attribute           & Description \\
 \hline
No Words            & Provides an empty string \\
 \hline
Custom File 	    & User-specified custom wordlist file \\
 \hline
Custom String 	    & User-specified custom string \\
 \hline
English Dictionary 	& English dictionary taken from the Unix words file \\
 \hline
Common Names        & -  \\
 \hline
Men                 & 1000 most common mens names in the US \\
 \hline
Women               & 1000 most common womens names in the US \\
 \hline
Pets                & 1200 most common pets names in the US \\
 \hline
Other 	            & \\
 \hline
Sland Expletives    & Wordlist of US slang and expletives \\
 \hline
Months Seasons      & Wordlist of months and seasons  \\
 \hline
\end{tabular}

\subsubsection*{Case}

\begin{tabular}{|l|l|l|l|}
 \hline
Attribute &	Description	& Input & 	Result \\
 \hline
No Case Change 	&Perform no action &	TeSt &	TeSt \\
Lowercase & & & \\
 \hline
Lowercase All &	Make word all lowercase &	TeSt & 	test \\
 \hline
Lowercase Fist, Upper rest &	Make first character lowercase and the rest of
the word uppercase &	TeSt &	tEST \\
 \hline
Uppercase & & &	 \\
 \hline
Uppercase All &	Make word all uppercase &	TeSt &	TEST \\
 \hline
Uppercrase Fisrt, Lower rest & 	Make first character uppercase and the rest of
the word lowercase &	TeSt 	& Test \\
 \hline
Toggle Nth &	Change the case of the Nth character &	TeSt (N=2) &	TESt \\
 \hline
\end{tabular}

\subsubsection*{Substitution}

\begin{tabular}{|l|l|l|l|}
 \hline
Attribute 	& Description &	Input &	Result \\
 \hline
No Substitution & Perform no action &	test &	test \\
 \hline
Replace All Instances & Replaces all instances of specified characters &
test('t'→'+') &	+es+ \\
 \hline
Replace First Instance & 	Replace the first instance of specified characters
& test ('t'→'+') &	+est \\
 \hline
Replace Last Instance &Replace the last instance of specified characters & test
('t'→'+') & 	tes+ \\
 \hline
\end{tabular}

Note: \verb+Replace First Instance+ and \verb+Replace Last Instance+ are not
compatible with Hashcat and John rules. If attempting to output rules using one
of these attributes in your chain, Mentalist will ask if you would like to
replace these attributes with the \verb+Replace All Instances+, which is a supported rule. 

\subsubsection*{Additional Substitution Options}
\begin{tabular}{|l|l|l|l|}
 \hline
Option & Input & Substitutions & Output \\
 \hline
One at a Time & apple & 'a'→'@' & @pple \\
              &       & 'e'→'3' & appl3 \\
 \hline
All at Once   & apple & 'a'→'@' &  \\
              &       & 'e'→'3' &	@ppl3 \\
 \hline
\end{tabular}

\subsubsection*{Append / Prepend}




\subsection*{Output}
\subsubsection*{Full Wordlist}

This option outputs the entire wordlist, as specified by the chain. The estimated number of words and filesize can be found in the top menu of Mentalist.

\subsubsection*{Hashcat/John Rules}

For offline cracking, there are times where the full wordlist is too large to output as a whole. In this case, it makes sense to output to rules so that Hashcat or John can programmatically generate the full wordlist.

Note that the First and Last Substitution attributes are not compatible with Hashcat/John. When a chain contains these attributes, saving to Hashcat/John will warn that First or Last will be changed to All in the rules output.

\subsubsection*{Base Words Only}

This output option allows you to output the base words into a single file to be used with your rules. This is useful if you have multiple sources of base words (multiple Base Word attributes). 


\subsection*{Persistence}
\subsubsection*{Saving Chains}

Mentalist is able to save chain files for future use. To save a chain file, go to Load/Save→Save Chain, which will then prompt you where you'd like to save the file. For organization, saved Mentalist chains should have the extension .mentalist, which is enforced in the application on most OSes.

\subsubsection*{Loading Chains}

Mentalist is able to load chain files by clicking on Load/Save→Load Chain. If
the chain file refers to a user-specified file that is not present on the
current system, Mentalist will put a red box around that file attribute and
will prevent processing. To fix this, click on the Fix\ldots button next to the file and specify a local file in its place.
