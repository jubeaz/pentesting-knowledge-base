\section{rpcclient}
\label{tool:rpcclient}

\subsection*{Introduction}
\href{https://www.samba.org/samba/docs/current/man-html/rpcclient.1.html}{rpcclient} is a handy tool created for use with the Samba protocol and to provide extra functionality via MS-RPC. It can enumerate, add, change, and even remove objects from AD. It is highly versatile; we just have to find the correct command to issue for what we want to accomplish. The man page for rpcclient is very helpful for this; just type man rpcclient into your attack host's shell and review the options available. 

\subsubsection*{tltr}
\begin{verbatim}
    Connect to a remote host: 
rpcclient --user domain\username%password ip
    Connect to a remote host on a domain without a password: 
rpcclient --user username --workgroup domain --no-pass ip
    Connect to a remote host, passing the password hash: 
rpcclient --user domain\username --pw-nt-hash ip
    Execute shell commands on a remote host: 
rpcclient --user domain\username%password --command semicolon_separated_commands ip
    Display domain users: 
rpcclient $> enumprivs
    Display information about a specific user: 
rpcclient $> queryuser username|rid
    Create a new user in the domain: 
rpcclient $> createdomuser username
\end{verbatim}

\subsection*{Common usages}


\subsubsection*{Retrieve password policy}
\label{tool:rpcclient:password-policy}
\begin{verbatim}
rpcclient -U "" -N 172.16.5.5

querydominfo
getdompwinfo
\end{verbatim}

\subsubsection*{Retrieve user list}
\label{tool:rpcclient:user-enum}
\verb+rpcclient -U "" -N 172.16.5.5+

\verb+enumdomusers+

\subsubsection*{Password Spraying}
\label{tool:rpcclient:password-spraying}

\begin{verbatim}
for u in $(cat USER_FILE); \
do rpcclient -U "$u%PASSWD" -c "getusername;quit" IP | grep Authority; done
\end{verbatim}

\subsubsection*{users Info}
\begin{verbatim}
queryuser RID
\end{verbatim}

\subsubsection*{}
\begin{verbatim}
enumdomgroups
\end{verbatim}


\subsubsection*{Shares}

\begin{verbatim}
netshareenumall
\end{verbatim}

\subsection*{Options}
\subsubsection*{Input}
\subsubsection*{General}
\subsubsection*{performance}
\subsubsection*{Output}

\subsection*{links}
\begin{itemize}
    \item \url{}
\end{itemize}
