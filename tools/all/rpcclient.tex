\section{rpcclient}
\label{tool:rpcclient}

\subsection*{Introduction}
\href{https://www.samba.org/samba/docs/current/man-html/rpcclient.1.html}{rpcclient} is a handy tool created for use with the Samba protocol and to provide extra functionality via MS-RPC. It can enumerate, add, change, and even remove objects from AD. It is highly versatile; we just have to find the correct command to issue for what we want to accomplish. The man page for rpcclient is very helpful for this; just type man rpcclient into your attack host's shell and review the options available. 

\subsection*{Common usages}
\subsubsection*{Retrieve password policy}
\label{tool:rpcclient:password-policy}
\begin{verbatim}
rpcclient -U "" -N 172.16.5.5

querydominfo
getdompwinfo
\end{verbatim}

\subsubsection*{Retrieve user list}
\label{tool:rpcclient:user-enum}
\verb+rpcclient -U "" -N 172.16.5.5+

\verb+enumdomusers+

\subsubsection*{Password Spraying}
\label{tool:rpcclient:password-spraying}

\begin{verbatim}
for u in $(cat USER_FILE); \
do rpcclient -U "$u%PASSWD" -c "getusername;quit" IP | grep Authority; done
\end{verbatim}

\subsubsection*{users Info}
\begin{verbatim}
queryuser RID
\end{verbatim}

\subsubsection*{}
\begin{verbatim}
enumdomgroups
\end{verbatim}


\subsection*{Options}
\subsubsection*{Input}
\subsubsection*{General}
\subsubsection*{performance}
\subsubsection*{Output}

\subsection*{links}
\begin{itemize}
    \item \url{}
\end{itemize}
