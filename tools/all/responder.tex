\section{Responder Suite}
\label{tool:responder}
\subsection*{Introduction}

Responder is a tool for performing a man-in-the-middle attack against authentication methods in Windows. This program includes the LLMNR, NBT-NS and MDNS poisoner, thanks to which traffic is redirected with requests and authentication hashes. The program also includes HTTP/SMB/MSSQL/FTP/LDAP authentication rogue servers that support authentication methods such as NTLMv1/NTLMv2/LMv2, Extended Security NTLMSSP and basic HTTP authentication, for which the Responder acts as a relay.

Responder can be used to attack the following protocols: LLMNR, DNS, MDNS,
NBNS, DHCP, ICMP, HTTP, HTTPS, SMB, LDAP, WebDAV, Proxy Auth, MSSQL, DCE-RPC,
FTP, POP3, IMAP, and SMTP auth


Responder will print it out on screen and write it to a log file per host
located in the \verb+/usr/share/responder/logs+ directory. Hashes are saved in
the format \verb+(MODULE_NAME)-(HASH_TYPE)-(CLIENT_IP).txt+

Hashes are also stored in a SQLite database that can be configured in the
\verb+Responder.conf+ config file, typically located in
\verb+/usr/share/responder+

\subsection*{Multi-relay attacks}
\url{https://aas-s3curity.gitbook.io/cheatsheet/internalpentest/active-directory/exploitation/exploit-without-account/smb-relay}

This is one of the newer features that @pythonresponder introduced towards the
end of 2016. 

Using this tool we can relay our NTLMv1/2 authentication to a specific target
and then, during a successful attack, execute code. Before we get into the
nitty gritty of this attack it should be stated that only privileged users are
targeted by default (good reasoning behind this) and the target cannot have SMB
signing in place. 

A nice script \verb+RunFinger.py+ has been packaged within the tools directory of
Responder and this allows to verify the latter on our target(s) before
actively targeting any hosts.


preparation of this attack we need to disable the SMB and HTTP servers 
used by Responder otherwise weâ€™ll get some conflicts between this and
Multi-relay (example shown below).



All saved Hashes are located in Responder's logs directory
(\verb+RESPONDER/logs/+)

\subsection*{Common usages}

\subsubsection*{Analyze the traffic}
\label{tool:responder:analyze}

\begin{verbatim}
sudo responder -I <INTERFACE> -A
\end{verbatim}

\subsubsection*{Listen and answer any requests}

\label{tool:responder:mitm}
\begin{verbatim}
sudo responder -I <INTERFACE> -wfv
\end{verbatim}

option \verb+-F+ and \verb+-P+ can be use but may cause a login prompt

The use of the \verb+-w+ flag utilizes the built-in WPAD proxy server. 
This can be highly effective, especially in large organizations, 
because it will capture all HTTP requests by any users that launch 
Internet Explorer if the browser has Auto-detect settings enabled.


\subsubsection*{Default Settings}
\begin{verbatim}
sudo responder -I <INTERFACE> 
\end{verbatim}


\subsection*{Configuration}

\verb+/usr/share/responder/Responder.conf+

\begin{itemize}
    \item \verb+RespondTo = <ip>, <ip-range+
\end{itemize}


\subsection*{Options}
\subsection*{links}

\url{https://www.ivoidwarranties.tech/posts/pentesting-tuts/responder/guide/}
\url{https://www.ivoidwarranties.tech/posts/pentesting-tuts/responder/cheatsheet/}
\url{https://miloserdov.org/?p=4055}
