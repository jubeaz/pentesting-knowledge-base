\section{windapsearch}
\label{tool:windapsearch}
\subsection*{Introduction}
\href{https://github.com/ropnop/windapsearch}{Windapsearch} is another handy Python script we can use to enumerate users, groups, and computers from a Windows domain by utilizing LDAP queries. 

\subsection{Enum Users and Domain Admin and priviledge users }
\begin{verbatim}
./windapsearch.py --dc-ip IP -u "" -U
windapsearch.py --dc-ip IP -u SAMAN -p PASSWD --da
windapsearch.py --dc-ip IP -u SAMAN -p PASSWD --PU
windapsearch.py --dc-ip IP -u SAMAN -p PASSWD --user-spns
\end{verbatim}

\subsection{CustomQueries}

\begin{verbatim}
# users requires a smart card for interactive logon
windapsearch --dc-ip  10.129.42.188 -d INLANEFREIGHT.LOCAL \
    -u james.cross@INLANEFREIGHT.LOCAL -p 'Academy_Student!' \
    --custom '(&(objectCategory=person)\
                (objectClass=user)\
                (userAccountControl:1.2.840.113556.1.4.803:=262144))'

#user account with  userAccountControl value set to ENCRYPTED_TEXT_PWD_ALLOWED
(reversible encrypted 
$ windapsearch --dc-ip  10.129.42.188 -d INLANEFREIGHT.LOCAL -u james.cross@INLANEFREIGHT.LOCAL -p 'Academy_Student!' --custom '(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=128))'

\end{verbatim}


\subsection*{Options}
\subsection*{links}
\url{}
