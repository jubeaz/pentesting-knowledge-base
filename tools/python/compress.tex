\section{Compression, encoding }

\subsection{zlib}
see also \verb+shutils+
\begin{verbatim}
import zlib
import base64
t=b'789c2b2d4e2db2ca28492a05d2d645f939a956c525a529a97925d62599b9a95686666686c6a666962616004e220e5a'
encodedStr = 'eJwrLU4tssooSSoF0tZF+TmpVsUlpSmpeSXWJZm5qVaGZmaGJiamRqYGAE4EDks='
print(zlib.decompress(base64.b64decode(encodedStr)))

str=b'user:htbuser;role:admin;time:1661445250'
print(base64.b64encode(zlib.compress(str)))
\end{verbatim}

\subsection{base64}
\subsection{md5}
\begin{verbatim}
import hashlib

str2hash = "md5.me"

result = hashlib.md5(str2hash.encode())
print(result.hexdigest())
\end{verbatim}


\subsection{hmac}

\begin{verbatim}
import hmac
import hashlib

hmac_calculated = hmac.new(config.SECRET_KEY.encode(), pickled, hashlib.sha512).digest()
cookie = base64.b64encode(pickled) + b'.' + base64.b64encode(hmac_calculated)

pickled_b64, hmac_given_b64 = cookie.split(".")
pickled = base64.b64decode(pickled_b64)
hmac_given = base64.b64decode(hmac_given_b64)

# Calculate the expected HMAC value and check if it matches
hmac_expected = hmac.new(config.SECRET_KEY.encode(), pickled, hashlib.sha512).digest()
if hmac_expected != hmac_given:
    return None
\end{verbatim}

\subsection{AES}
\begin{verbatim}
from cryptography.fernet import Fernet
import base64
import hashlib


class encryptAES:
    def __init__(self, data):
        self.data = data
        self.key = base64.b64encode(hashlib.sha256(
            app.config['SECRET_KEY'].encode()).digest()[:32])
        self.f = Fernet(self.key)

    def encrypt(self):
        encrypted = self.f.encrypt(self.data)
        return base64.b64encode(encrypted).decode()

    def decrypt(self):
        encrypted = base64.b64decode(self.data)
        return self.f.decrypt(encrypted)
\end{verbatim}
