\section{PSify an c\# exe}

this is taken from
\href{https://github.com/S3cur3Th1sSh1t/PowerSharpPack.git}{PowerSharpBinaries}
\begin{verbatim}
So what did i basically do here?
    First of all clone each C# Repo.
    Set the class and main methods public
    Afterwards compiling each binary
    Gzip-compress and base64-Encode the binary base64 and load it in powershell via 
        [System.Reflection.Assembly]::Load($DecompressedDecodedBinary).
\end{verbatim}

\begin{verbatim}
function Invoke-Whisker
{

    [CmdletBinding()]
    Param (
        [String]
        $Command = ""

    )
    $a=New-Object IO.MemoryStream(,[Convert]::FromBAsE64String("HERE"))
    $decompressed = New-Object IO.Compression.GzipStream($a,[IO.Compression.CoMPressionMode]::DEComPress)
    $output = New-Object System.IO.MemoryStream
    $decompressed.CopyTo( $output )
    [byte[]] $byteOutArray = $output.ToArray()
    $RAS = [System.Reflection.Assembly]::Load($byteOutArray)
    
    $OldConsoleOut = [Console]::Out
    $StringWriter = New-Object IO.StringWriter
    [Console]::SetOut($StringWriter)

    [Whisker.Program]::main($Command.Split(" "))

    [Console]::SetOut($OldConsoleOut)
    $Results = $StringWriter.ToString()
\end{verbatim}

it is then possible to dot-source the function and call it
\begin{verbatim}
PS C:\Users\btables\Desktop> . Invoke-Whisker.ps1
PS C:\Users\btables\Desktop> gci -Path Function:\Invoke-Whisker
PS C:\Users\btables\Desktop> Invoke-Whisker
\end{verbatim}

