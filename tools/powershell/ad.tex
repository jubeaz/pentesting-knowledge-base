\section{LDAP}

\subsection{LDAPFilter}
\begin{verbatim}
Criteria 	        Rule 	            Example
Equal to 	        (attribute=123) 	(&(objectclass=user)(displayName=Smith)
Not equal to 	    (!(attribute=123)) 	!objectClass=group)
Present 	        (attribute=*) 	    (department=*)
Not present 	    (!(attribute=*)) 	(!homeDirectory=*)
Greater than 	    (attribute>=123) 	(maxStorage=100000)
Less than 	        (attribute<=123) 	(maxStorage<=100000)
Approximate match 	(attribute~=123) 	(sAMAccountName~=Jason)
Wildcards 	        (attribute=*A) 	    (givenName=*Sam)
\end{verbatim}

\begin{verbatim}
Matching rule OID 	String identifier 	Description
1.2.840.113556.1.4.803 	LDAP_MATCHING_RULE_BIT_AND 	
1.2.840.113556.1.4.804 	LDAP_MATCHING_RULE_BIT_OR 
1.2.840.113556.1.4.1941 LDAP_MATCHING_RULE_IN_CHAIN     This rule is limited to
filters that apply to the DN. This is a special "extended" match operator that
walks the chain of ancestry in objects all the way to the root until it finds a
match.
\end{verbatim}

\begin{verbatim}
# all administratively disabled user accounts
Get-ADUser -LDAPFilter '(userAccountControl:1.2.840.113556.1.4.803:=2)' | select name

# select groups of a user
Get-ADGroup -LDAPFilter
    '(member:1.2.840.113556.1.4.1941:=CN=Harry...,DC=INLANEFREIGHT,DC=LOCAL)' |
    select Name
Get-ADGroup -Filter 'member -RecursiveMatch "CN=Harry...  ,DC=INLANEFREIGHT,DC=LOCAL)' |
    select Name

# select users with a desc
Get-ADUser -Properties * -LDAPFilter '(&(objectCategory=user)(description=*))'
\end{verbatim}

\subsection{SearchBase and SearchScope}

\verb+SearchBase+ parameter specifies an Active Directory path to search under.

\verb+SearchScope+ allows us to define how deep into the OU hierarchy we would
like to search.

\begin{itemize}
    \item \verb+Base+ (0) 	The object is specified as the SearchBase
    \item \verb+OneLevel+ (1) 	Searches for objects in the container defined
        by the SearchBase but not in any sub-containers.
    \item \verb+SubTree+ (2) 	Searches for objects contained by the
        SearchBase and all child containers, including their children,
        recursively all the way down the AD hierarchy.
\end{itemize}

\begin{verbatim}
Get-ADObject -SearchBase "OU=Employees,DC=INLANEFREIGHT,DC=LOCAL" ` 
    -SearchScope Base -Filter *
\end{verbatim}
