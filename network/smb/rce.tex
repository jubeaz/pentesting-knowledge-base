\subsection{Remote code execution}

RCE is enable by the use of MSRPC over SMB. Different
tehcniques exists such as deploying a service to the \verb+admin$+ share then
accessing the Windows Service Control Manager API and starting the service and
create a named pipes for sending commands.


tools to use:
\begin{itemize}
    \item SysInternals PsExec~\ref{tools:sysinternals:psexec}
    \item Impacket PSExec~\ref{tools:impacket:psexec}
    \item Impacket SMBExec~\ref{tools:impacket:smbexec}
    \item Impacket atexec~\ref{tools:impacket:atexec}
    \item CrackMapExec~\ref{tools:crackmapexec:smb:rce}
    \item Metasploit PsExec~\ref{tools:metasploit}
\end{itemize}
