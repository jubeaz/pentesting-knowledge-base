
\section{Interaction}

\subsection{Evil-WinRM}
See~\ref{tool:evil-winrm}

\verb+evil-winrm -i <target-IP> -u <username> -p <password>+

\subsection{PowerShell}
See~\ref{tool:wlol:powershell:cmdlet:winrm-session}

\begin{verbatim}
$password=ConvertTo-SecureString '<password>' -Asplaintext -force;
$creds=New-Object System.Management.Automation.PSCredential("domain_netbios>\<user>", $password);

$sess = New-PSSession -ComputerName <target_name> `
    -Credential $creds -Authentication 'Credssp' `
    -SessionOption (New-PSSessionOption `
    -ProxyAccessType NoProxyServer) 

    Enter-PSSession $sess
\end{verbatim}

\begin{verbatim}
$password=ConvertTo-SecureString '<password>' -Asplaintext -force;
$creds=New-Object PSCredential("domain_netbios>\<user>", $password);

Register-PSSessionConfiguration -Name <config_name>  -RunAsCredential $creds
Restart-Service WinRM
Enter-PSSession -ComputerName <target_name>' `
    -Credential $creds -Authentication 'Credssp' `
    -ConfigurationName <config_name>
\end{verbatim}



\href{https://learn.microsoft.com/en-us/powershell/module/microsoft.wsman.management/enable-wsmancredssp?view=powershell-7.4}{Enable-WSManCredSSP}

\href{https://www.techtarget.com/searchwindowsserver/tutorial/How-to-avoid-the-double-hop-problem-with-PowerShell}{How to avoid the double-hop problem with PowerShell}


