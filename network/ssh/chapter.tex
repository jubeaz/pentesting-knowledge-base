\chapter{SSH}

\input{network/ssh/intro}

\input{network/ssh/enum}

\section{SSH Hijacking}
With root access on a system, it is possible to compromise an active SSH
session to another machine via public key authentication. It is possible to
compromise the SSH agent or gain access to the SSH agent’s unix domain socket
and hijack the connection.

ssh-agent creates a unix domain socket, and then listens for connections from
the sshd daemon to this socket. Based on the permissions of this socket, any of
the authentication keys that are used by the socket can be compromised to any
user who can connect to the socket.

\begin{enumerate}
    \item find the sshd process id (\verb+ ps -aux |grep sshd+)
    \item find the \verb+SSH_AUTH_SOCK+ env var for tje sshd(\verb+grep SSH_AUTH_SOCK /proc//environ+)
    \item hijack thee ssh-agent socket (\verb+SSH_AUTH_SOCK=/tmp/ssh-XXXXXXX/agent.XXXX ssh-add –l+)
\end{enumerate}

\input{network/ssh/mitm}
\input{network/ssh/bruteforce}
\input{network/ssh/postexploit}


