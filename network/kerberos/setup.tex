\section{Linux setup}
\subsection{Attacking from non domain joined linux}
. If we use them from a domain-joined machine, we need to ensure our KRB5CCNAME environment variable is set to the ccache file we want to use. In case we are attacking from a machine that is not a member of the domain, for example, our attack host, we need to make sure our machine can contact the KDC or Domain Controller, and that domain name resolution is working.

In this scenario, our attack host doesn't have a connection to the KDC/Domain
Controller, and we can't use the Domain Controller for name resolution. To use
Kerberos, we need to proxy our traffic via MS01 with a tool such as Chisel and
Proxychains and edit the /etc/hosts file to hardcode IP addresses of the domain
and the machines we want to attack. 

\subsection{Adjusting time}

\begin{verbatim}
$ sudo timedatectl set-ntp false
$ ## edit /etc/systemd/timesyncd.conf to point
$ cat /etc/systemd/timesyncd.conf |grep '^NTP'
NTP=dc.intelligence.htb
# $ sudo timedatectl set-ntp true
\end{verbatim}

if it does not works

\begin{verbatim}
$ nmap -sV -sC 10.10.10.10
clock-skew: mean: -1998d09h03m04s, deviation: 4h00m00s, median: -1998d11h03m05s

$ nmap -sT dc01.coder.htb -p445 --script smb2-time -vv
Host script results:
| smb2-time:
|   date: 2023-04-03T09:15:47
|_  start_date: N/A
\end{verbatim}



\begin{verbatim}
$ sudo timedatectl set-ntp false
$ ldapsearch -LLL -x -H ldap://10.10.10.248 -b '' -s base '(objectclass=*)' |
    grep currentTime
currentTime: 20230128092311.0Z
$ sudo timedatectl set-time '2023-01-28 10:31:31'
\end{verbatim}

\subsection{Setup Kerberos client}

some tools such as \verb+evil-winrm+ require \verb+krb5+ package

\begin{verbatim}
$ cat /etc/krb5.conf

[libdefaults]
        default_realm = INLANEFREIGHT.HTB

<SNIP>

[realms]
    INLANEFREIGHT.HTB = {
        kdc = dc01.inlanefreight.htb
    }

<SNIP>
\end{verbatim}

might need to setup some hosts in \verb+/etc/hosts+


