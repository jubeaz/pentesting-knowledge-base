
\section{Post-exploit}


\subsection{GAL dumping}

\subsubsection{Global Address List OWA Extractor}

\href{https://github.com/pigeonburger/global-address-list-owa}{Global Address List OWA Extractor}

This script doesn't bypass SSL errors, so GET and POST must be modified adding \verb+verify=False+ to the functions call params


\subsubsection{Impacket exchanger (NSPI)}

\subsubsection{ruler}
\begin{verbatim}
./ruler -k -d <domain> -u <user> -p '<password' -e <user_email> --verbose \
    abk dump -o gal.txt
\end{verbatim}

\subsubsection{MailSniper}
\begin{verbatim}
Get-GlobalAddressList 
    -ExchHostname <fqdn> -UserName <>omain_netbios\<user> -Password '<password>'
    -OutFile gal.txt
\end{verbatim}


\subsection{Email interaction}

\href{https://github.com/3gstudent/Homework-of-Python/blob/master/ewsManage.py}{ewsManage.py}:
\begin{verbatim}
python ewsManage.py 10.10.110.254 443 plaintext RLAB ahope Summer2023 findallpeople
\end{verbatim}



\begin{verbatim}
ewsManage.py <host> <port> <mode> <domain> <user> <password> <command>
<mode>:
- plaintext
- ntlmhash
<command>:
- getfolderofinbox
- getfolderofsentitems
- listmailofinbox
- listmailofsentitems
- listmailoffolder
- getmail
- deletemail
- deletefolder
- getattachment
- saveattachment
- getdelegateofinbox
- adddelegateofinbox
- updatedelegateofinbox
- removedelegateofinbox
- getdelegateofinbox2
- updatedelegateofinbox2
- restoredelegateofinbox2
- getinboxrules
- updateinboxrules
- removeinboxrules
- deleteattachment
- createattachment
- createfolderofinbox
- listhiddenfolderofinbox
- createtestmail
- SetHiddenPropertyType
- UpdateHiddenPropertyType
- getcontact
- findpeople
- findallpeople
- resolvename
- resolveallname
\end{verbatim}


\subsection{OAB}
require access to \verb+autodiscover+

\href{https://ppn.snovvcrash.rocks/pentest/perimeter/exchange#oab}{Exchange OAB}

\subsection{Shares accessing}

\url{https://ppn.snovvcrash.rocks/pentest/perimeter/exchange#activesync}

