\subsection{Valid user enumeration}


\subsubsection{Powershell MailSniperi (OWA/EWS)}
\begin{verbatim}
Invoke-UsernameHarvestOWA –UserList .\username_list.txt 
    –ExchHostname mail.domain.com –Domain the_identified_internal_domain_name 
    –OutFile potential_usernames.txt -Threads 25
\end{verbatim}

\subsubsection{Metasploit (OWA)}
msf (\verb+auxiliary/scanner/http/owa_login+)

\subsubsection{msmailprobe (OWA)}
\begin{verbatim}
msmailprobe userenum --onprem -t rastalabs.local -U ./users.txt -o valids.txt
\end{verbatim}


