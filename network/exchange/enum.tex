\section{Footprint / enumeration}

\subsection{ffuf}
wordlists:
\begin{itemize}
    \item 
        \href{https://raw.githubusercontent.com/danTaler/WordLists/master/OWA-Attack.txt}{OWA-Attack.txt}
\end{itemize}

\subsection{NTLM endpoints}

\subsubsection{ntlmscan/ntlm-scanner}

\href{https://github.com/nyxgeek/ntlmscan}{ntlmscan}:
\begin{verbatim}
 python ./ntlmscan.py --host 10.10.110.254 --dictionary OWA-Attack.txt --nmap
\end{verbatim}

\href{https://github.com/preempt/ntlm-scanner}{ntlm-scanner}:

\subsubsection{nmap}
\begin{verbatim}
sudo nmap -sV --script http-ntlm-info --script-args http-ntlm-info.root=/ews/ -p443 <ip>
\end{verbatim}


\subsubsection{ntlmdecoder.py}

\href{https://gist.github.com/aseering/829a2270b72345a1dc42#file-ntlmdecoder-py}{ntlmdecoder.py}


\subsection{msmailprobe}
identify:
\begin{itemize}
    \item domain name
    \item endpoints vulnerable to time-based enumeration
    \item endpoints for pasword spraying
\end{itemize}

\href{https://github.com/busterb/msmailprobe}{msmailprobe}
\begin{verbatim}
msmailprobe identify -t mx01.rastalabs.local
\end{verbatim}

\subsection{check auth method and ntlm info}

\begin{verbatim}
sudo nmap -Pn -n -sV  -p443  \
    --script=http-auth \
    --script-args http-auth.path=/<path> \
    <ip>
\end{verbatim}

get NetBIOS domain name and Exchange hostname

\begin{verbatim}
sudo nmap -Pn -n -sV  -p443  \
    --script=http-ntlm-info \
    --script-args http-ntlm-info.root=/<path> 
    <ip>
\end{verbatim}


\subsection{Exchange version}
\href{https://exchangeserverversions.blogspot.com/}{Microsoft Exchange Server Versions}


\begin{verbatim}
curl -iks https://mx01.rastalabs.local/owa |grep x-owa-version 
curl -sSL https://mx1.example.com/owa/auth/logon.aspx | grep favicon.ico
curl https://10.129.230.37/ecp/Current/exporttool/microsoft.
exchange.ediscovery.exporttool.application -k | xmllint --format - | grep version  
\end{verbatim}


\begin{verbatim}
python3 utils/linux/get_exchange_version.py https://mx01.rastalabs.local/owa
\end{verbatim}



