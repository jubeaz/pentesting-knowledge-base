\section{Tools}

\subsection{sccmhunter}

\href{https://github.com/garrettfoster13/sccmhunter/tree/main}{SCCMHunter}

store results in \verb+.sccmhunter/logs/db/find.db+

remove version in \verb+requirements.txt+

\subsection{SharpSCCM}
\href{https://github.com/Mayyhem/SharpSCCM}{SharpSCCM}
\subsection{malSCCM}
\href{https://github.com/nettitude/MalSCCM}{MalSCCM}



\subsection{pxethief.py (linux)}

\href{https://github.com/csandker/pxethiefy}{pxethiefy.py}

\subsection{PXEThief (windows)}

\href{https://github.com/MWR-CyberSec/PXEThief}{PXEThief} 
\begin{itemize}
    \item 
        python3 (tested ok on python 3.10)
    \item 
        obviously clone the project \verb+https://github.com/MWR-CyberSec/PXEThief+
    \item 
        install pxethief requirements.txt (\verb+py.exe -m pip install -r requirements.txt+)
    \item 
        install npcap (\verb+https://npcap.com/#download+))
    \item 
        install tftp client ( \verb+Control Panel > Programs > Turn windows feature on or off > check tftp client+)
    \item 
        disable your firewall (or enable tftp in it)
\end{itemize}

\verb-$env:path = 'C:\Users\jubeaz.HAAS\AppData\Local\Programs\Python\Launcher;' + $env:PATH-

he PowerShell script below will attempt to download and install the above requirements. npcap is not able to be installed silently and will require manual intervention to finalise.

\begin{verbatim}
if (-not ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {
    Write-Warning "Not running as administrator. Please run this script as an administrator." ; break
}

$urls = @{
    Npcap = "https://nmap.org/npcap/dist/npcap-1.79.exe";
    Python = "https://www.python.org/ftp/python/3.12.3/python-3.12.3-amd64.exe";
    PXEThief = "https://codeload.github.com/MWR-CyberSec/PXEThief/zip/refs/heads/main"
}

$installers = @{
    Npcap = "npcap-installer.exe";
    Python = "python-installer.exe";
    PXEThief = "PXEThief-main.zip"
}

$urls.GetEnumerator() | % {IWR -Uri $_.Value -OutFile $installers[$_.Key] -Verbose}
Expand-Archive -Path $installers["PXEThief"] -DestinationPath "." -Force
try {Enable-WindowsOptionalFeature -Online -FeatureName "TFTP-Client" -NoRestart} 
catch {Install-WindowsFeature -Name "TFTP-Client"}

Start-Process -FilePath $installers["Python"] -ArgumentList "/quiet InstallAllUsers=1 PrependPath=1" -Wait -NoNewWindow
Write-Host "Please manually install Npcap using the installer provided if required." -ForegroundColor Yellow
Start-Process -FilePath $installers["Npcap"] -Wait -NoNewWindow
Start-Sleep -Seconds "20"
Set-Location -Path "PXEThief-main"
Start-Process -FilePath "cmd.exe" -ArgumentList '/c py.exe -m pip install -r requirements.txt' -Wait -NoNewWindow
switch ((Read-Host "Create Firewall Exception for Outbound TFTP? y/n").ToLower()) {
    'y' { try {New-NetFirewallRule -DisplayName "Allow Outbound TFTP" -Direction Outbound -Protocol UDP -LocalPort 69 -Action Allow} catch {Write-Host "Failure Creating Firewall Rule" -ForegroundColor "Red"} }
    'n' { continue }
    default { Write-Host "Invalid input, moving on..." -ForegroundColor "Yellow" }
}
Write-Host "Script execution completed. Check the current directory for downloaded files and installation status." -ForegroundColor Green
\end{verbatim}
