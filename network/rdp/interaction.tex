
\section{Interaction}
\subsection{xfreerdp}

\begin{verbatim}
xfreerdp /u:Helen /p:'RedRiot88' /d:inlanefreight.local /v:10.129.229.244 /dynamic-resolution /drive:.,linux
xfreerdp /cert:ignore /u:<user>@<domain_fqdn> /pth:<nt_hash> /v:<ip> 
    /h:1024 /w:1640 /drive:<name|share>,<share|./> +drives

# low latency 
xfreerdp /cert:ignore /u:<user>@<domain_fqdn> /pth:<nt_hash> /v:<ip>
    /h:1024 /w:1640 /drive:<name|share>,<share|./> +drives
    /bpp:8 /compression -themes -wallpaper /clipboard /audio-mode:0 
    /auto-reconnect -glyph-cache
\end{verbatim}

xfreerdp /cert:ignore /u:vagrant /p:vagrant /v:172.16.3.20     /h:1024 /w:1640 /drive:share,./ +drives     /bpp:8 /compression -themes -wallpaper /clipboard /audio-mode:0      /auto-reconnect -glyph-cache


\subsection{SharpRDP}
SharpRDP is a .NET tool that allows for non-graphical, authenticated remote command execution through RDP, leveraging the \verb+mstscax.dll+ library used by RDP clients. This tool can perform actions such as connecting, authenticating, executing commands, and disconnecting without needing a GUI client or SOCKS proxy.

SharpRDP relies on the terminal services library (\verb+mstscax.dll+) and generates the required DLLs (\verb+MSTSCLib.DLL+ and \verb+AxMSTSCLib.DLL+) from the \verb+mstscax.dll+. It uses an invisible Windows form to handle the terminal services connection object instantiation and perform actions needed for lateral movement.

{\bf Note: The execution of commands of SharpRDP is limited to 259 characters.}


SharpRDP uses Microsoft run to execute commands, we can use \href{https://github.com/0xthirteen/CleanRunMRU}{CleanRunMRU} to clean all command records.

\begin{verbatim}
C:\Windows\Microsoft.NET\Framework\v4.0.30319\csc.exe .\CleanRunMRU.cs
.\CleanRunMRU.exe  clearall
\end{verbatim}
