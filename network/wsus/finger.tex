
\section{Fingerprinting}

\subsubsection{WSUS over HTTP}
\begin{verbatim}
reg query HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate /v WUServer
\end{verbatim}
If the key doesnâ€™t exist, then the public Windows Update server will be used
for updates. If WSUS is being used, the value will be something like
\verb+http://wsus-server.local:8530+. If the URL does not start with https,
then the computer is vulnerable to the injection attack.

\begin{verbatim}
req query HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\AU /v UseWUServer
\end{verbatim}
If this is set to 0 then the WUServer setting will be ignored. If set to 1, the
WSUS URL will be used.