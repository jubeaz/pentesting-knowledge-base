\chapter{Principles of security}
\section{CIA Triad}
\begin{itemize}
    \item Confidentiality
    \item Integrity
    \item Availability
\end{itemize}

\section{Principles of privileges}

he levels of access given to individuals are determined on two primary factors:
\begin{itemize}
    \item The individual's role/function within the organisation
    \item The sensitivity of the information being stored on the system
\end{itemize}


PIM  is used to translate a user's role within an organisation into an  access role on a system. Whereas PAM is the management of the privileges  a system's access role has, amongst other things.

\section{Attack Terminology}
On a computer network, it is possible for users to initiate actions that can
subvert the security of computer systems other than their own. These types of
actions are called {\bf attacks}. Usually the attacker aims to influence the
confidentiality, integrity, or accessibility (CIA) of the target system.
Successful attacks often rely on specific {\bf vulnerabilities} present in the
target system. The two most common topics when discussing attacks are attack
vectors and attack surfaces. 

\subsection{Attack vector}
An attack vector generally refers to the means by which an attacker makes his
move. It describes the methods used to carry out an attack. it describes how
you reach any given vulnerable code. Attack vectors can be classified based on
several criteria, including authentication, accessibility, and difficulty.
These criteria are often used to prioritize how to respond to publicly
disclosed vulnerabilities or ongoing attacks. 

Attack vectors are often further classified based on properties of common
attacks. For example, sending electronic mail with an attachment is a more
specific attack vector than just sending electronic mail. To go further, you
could specify the exact type of attachment.  Another, more specific attack
vector based on electronic mail is one where an attacker includes a clickable
uniform resource locator (URL) inside the message. 

Another example is an image processing library. Such a library may have many
functions that lead to execution of the vulnerable function. These can be
considered vectors to the vulnerable function. Likewise, a subset of the
application programming interface (API) exposed by the library may trigger
execution of the vulnerable function. Any of these API functions may also be
considered a vector. Finally, any program that leverages the vulnerable library
could also be considered a vector.

These classifications help defenders think about how attacks could be blocked
and help attackers isolate where to find interesting code to audit.

{\bf Note:} MITRE’s Common Attack Pattern Enumeration and Classification
(CAPEC) project aims to enumerate and classify attacks into patterns. This
project includes and extends on the concept of traditional attack vectors. 

\subsection{Attack Surfaces}
An attack surface is generally understood as a target’s open flanks—that is to
say, the characteristics of a target that makes it vulnerable to attack. 

More technically speaking, an attack surface refers to the code that an
attacker can execute and therefore attack. In contrast to an attack vector, an
attack surface does not depend on attackers’ actions or require a vulnerability
to be present.  Simply put, it describes where in code vulnerabilities might be
waiting to be discovered. 

In a browser-based attack, all the web-related technologies supported by the
browser constitute attack surfaces (HTTP, HTML, CSS, SVG,\ldots).  Remember,
though, by definition, no vulnerabilities need be present for an attack surface
to exist. If a particular piece of code can be exercised by an attacker, it is
a considered an attack surface and should be studied accordingly.

Similar to attack vectors, attack surfaces can be discussed both in general and
in increasingly specific terms. Exactly how specific one chooses to be usually
depends on context. If someone is discussing the attack surface of an Android
device at a high level, they might point out the wireless attack surface. In
contrast, when discussing the attack surface of a particular program they might
point out a specific function or API. Further still, in the context of local
attacks, they might point out a specific file system entry on a device.
Studying one particular attack surface often reveals additional attack
surfaces, such as those exposed through multiplexed command processing. A good
example is a function that parses a particular type of packet inside a protocol
implementation that encompasses many different types of packets. Sending a
packet of one type would reach one attack surface whereas sending a packet of
another type would reach a different one.

 Consider the outermost attack surface of the system in question consists of
 the two web server ports. If the attack vector is a normal request (not an
 encrypted one), the underlying attack surface of the web server software, as
 well as any server-side web applications, are reachable. Choosing to target a
 PHP web application, application code and the PHP interpreter both handle
 untrusted data. As untrusted data is passed along, more attack surfaces are
 exposed to it.

On a final note, a given attack surface might be reachable by a number of
attack vectors. For example, a vulnerability in an image processing library
might be triggered via an e-mail, a web page, an instant messaging application,
or other vectors. This is especially relevant when vulnerabilities are patched.
If the fix is only applied to one vector, the issue may still be exploited via
remaining vectors.

\subsection{Classifying Attack Surfaces}

Generally the size of a target’s attack surface is directly proportional to how
much it interfaces with other systems, code, devices, users, and even its own
hardware.  Because the attack surface of a system  is so vast, dissection and
classification is necessary.

\subsubsection{Surface Properties}
Researchers look at the various proper ties of attack surfaces to make
decisions.  Key properties and the reasoning behind their importance:
\begin{itemize}
    \item {\bf Attack Vector}:  user interaction and authentication
        requirements limit the impact of any vulnerability discovered in a
        given attack surface. Attacks that require the target user to do
        something extraordinary are less severe and may require social
        engineering to succeed. Likewise, some attack surfaces can be reached
        only with existing access to the device or within certain physical
        proximities.
    \item {\bf Privileges Gained}: The code behind a given attack surface might
        execute with extremely high privileges (such as in kernel-space), or it
        might execute inside a sandbox with reduced privileges.
    \item {\bf Memory Safety}: Programs written in non-memory-safe languages
        like C and C++ are susceptible to more classes of vulnerabilities than
        those written with memory-safe languages like Java.
    \item {\bf Complexity}: Complex code, algorithms, and protocols are
        difficult to manage and increase the probability of a programmer making
        a mistake
\end{itemize}
By focusing on particularly risky attack surfaces (low requirements, high
privileges, non-memory-safe, high complexity, and so on), a system can be
attacked or secured more quickly. As a general rule, an attacker seeks to gain
as much privilege as possible with as little investment as possible. Thus,
especially risky attack surfaces are a logical place to focus.

\subsection{Classification Decisions}
Because systems have such a large and complex set of attack surfaces, it is
necessary to break them down into groups based on common properties.  


\subsubsection{Remote attack surface}
The largest and most attractive attack surface exposed by any computer system,
is classified as remote. 

Various properties further divide remote attack surfaces into distinct groups.
Some remote attack surfaces are always reachable whereas others are reachable
only when the victim initiates network communications.

Issues where no interaction is required are especially dangerous because they
are ripe for propagating network worms. Issues that require minor interaction,
such as clicking a link, can also be used to propagate worms, but the worms
would propagate less quickly. Other attack surfaces are reachable only when the
attacker is in a privileged position, such as on the same network as his
victim. Further, some attack surfaces only deal with data that has already been
processed by an intermediary, such as a mobile carrier or Google.


\subsubsection{Physical adjacency}
Unlike physical attacks, which require directly touching the target device,
physically adjacent attacks require that an attacker is within a certain range
of her intended victim. Much of this attack surface involves various types of
radio frequency (RF) communications (bluetooth, nfc, wifi). 

\subsubsection{Local attack surfaces}

\subsubsection{Physical attack surfaces}


\subsubsection{third-party modifications}

\section{ Threat Modelling and Incident Response}
\url{https://mozilla.github.io/seasponge/#/about}{seasponge} An open sourced
and client-side HTML5 Threat Modelling Tool from Mozilla.

\url{https://owasp.org/www-community/Threat_Modeling}


\subsection{STRIDE}
\begin{tabularx}{\textwidth}{|l|X|}
    \hline 
 Principle & Description \\
    \hline 
 Spoofing & This  principle requires you to authenticate requests and users accessing a  system. Spoofing involves a malicious party falsely identifying itself  as another.
ccess keys (such as API keys) or signatures via encryption helps remediate this
threat. \\
    \hline 
 Tampering & By  providing anti-tampering measures to a system or application, you help  provide integrity to the data. Data that is accessed must be kept  integral and accurate.
For example, shops use seals on food products. \\
    \hline 
Repudiation & This principle dictates the use of services such as logging of
activity for a system or application to track. \\
    \hline 
Information Disclosure & Applications or services that handle information of
multiple users need to be appropriately configured to only show information
relevant to the owner is shown. \\
    \hline 
Denial of Service & Applications and services use up system resources, these
two things should have measures in place so that abuse of the
application/service won't result in bringing the whole system down.\\
    \hline 
Elevation of Privilege & This is the worst-case scenario for an application or
service. It means that a user was able to escalate their authorization to that
of a higher level i.e. an administrator. This scenario often leads to further
exploitation or information disclosure. \\
    \hline 
\end{tabularx}

\subsection{Computer Security Incident Response Team (CSIRT)}


\begin{tabularx}{\textwidth}{|l|X|}
    \hline 
Action & Description \\
    \hline 
Preparation & Do we have the resources and plans in place to deal with the
security incident? \\
    \hline 
Identification & Has the threat and the threat actor been correctly identified
in order for us to respond to? \\
    \hline 
Containment & Can the threat/security incident be contained to prevent other
systems or users from being impacted? \\
    \hline 
Eradication & Remove the active threat. \\
    \hline 
Recovery & Perform a full review of the impacted systems to return to business
as usual operations. \\
    \hline 
Lessons Learned & What can be learnt from the incident? I.e. if it was due to a
phishing email, employees should be trained better to detect phishing emails.
\\
    \hline 
\end{tabularx}
