
\section{Stack Exploitation}

\subsection{Introduction}
The most basic forms of binary exploitation occur on the stack.
Because the {\bf Instruction Pointer} is saved on the stack, just like 
local variables. When a function is called and when the function return it pops
the instruction pointer and jump to it. If an attacker is able to write more characters than the
program expects, he can overwrite the value and redirect code execution to
wherever we wish. Functions such as \verb+fgets()+ can prevent such easy
overflow, but you should check how much is actually being read.

The first thing is to try to identify a vulnerable function that will produce a
segmentation fault when to much data is provided. This will occurs because the
instruction pointer will be overwritten by the data and the \verb+ret+
instruction will jump to an invalid address.

in order to be efficient it is possible to provide a {\bf e Bruijn sequences of
order $n$}, which is simply a sequence where no string of \verb+n+ characters
is repeated.

this can be done using \verb+pwntools-pwn cyclic+ or \verb+pattern_create.rb+ of
metasploit. 
\begin{verbatim}
p/opt/metasploit/tools/exploit/attern_create.rb -l <size> 
pwntools-pwn cyclic <size>
\end{verbatim}

when such a string is provided and generate a segmentation fault, the
instruction pointer will contain a substring of the sequence. It is then
possible to obtain the offset of the instruction pointer in the input
\begin{verbatim}
/opt/metasploit/tools/exploit/pattern_offset.rb -q Aa3A
pwntools-pwn cyclic -l faad
\end{verbatim}

\subsection{ret2win}
A ret2win is simply a binary where there is a {\emph win} function to which the
redirection to it is sufficient.


\subsection{shellcode}

\subsection{NOPs}


\subsection{Return oriented programming (ROT)}

\subsection{Format string bug}


\subsection{Canaries}



\subsection{Stack pivoting}
Stack Pivoting is a technique used when facing lack space on the stack - for
example, having 16 bytes past RIP. In this scenario, it isnot possible to
complete a full ROP chain.

During Stack Pivoting, the shellcode take control of the RSP register and
"fake" the location of the stack. There are a few ways to do this.

\url{https://ir0nstone.gitbook.io/notes/types/stack/stack-pivoting}


