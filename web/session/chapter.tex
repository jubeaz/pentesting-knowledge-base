\chapter{Session security}
\input{web/session/intro}
\input{web/session/hijack}
\input{web/session/fixation}
\input{web/session/without-interaction}
\input{web/session/xss}
\input{web/session/csrf}
\input{web/session/chain}

\section{Weak CSRF token}

When assessing how robust a CSRF token generation mechanism is, make sure you
spend a small amount of time trying to come up with the CSRF token generation
mechanism. It can be as easy as \verb+md5(username)+, \verb+sha1(username)+, 
\verb-md5(current date + username)- etc. Please note that you should not spend
much time on this, but it is worth a shot.

\section{Additional CSRF Protection Bypasses}

\begin{itemize}
    \item null value
    \item random value
    \item use another session csrf token
    \item request method tampering
    \item delete the csrf token parameter and send a blank token
    \item csrf fixation
\end{itemize}

If  Referrer header is used  try  \verb+<meta name="referrer" content="no-referrer" />+
ometimes the Referrer has a whitelist regex or a regex that allows one specific
domain. 



\section{Open Redirect}

An Open Redirect vulnerability occurs when an attacker can redirect a victim to
an attacker-controlled site by abusing a legitimate application's redirection
functionality. In such cases, all the attacker has to do is specify a website
under their control in a redirection URL of a legitimate website and pass this
URL to the victim. As you can imagine, this is possible when the legitimate
application's redirection functionality does not perform any kind of validation
regarding the websites to which the redirection points. From an attacker's
perspective, an open redirect vulnerability can prove extremely useful during
the initial access phase since it can lead victims to attacker-controlled web
pages through a page that they trust.


\begin{verbatim}
$red = $_GET['url'];
header("Location: " . $red);
\end{verbatim}

Make sure you check for the following URL parameters when bug hunting, you'll
often see them in login pages. Example: \verb+/login.php?redirect=dashboard+


