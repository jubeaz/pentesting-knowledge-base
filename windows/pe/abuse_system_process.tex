\section{Create or Modify System Process (T1543)}
\label{mitre:t1543}


\subsection{Windows Service (T1543.003)}
\label{mitre:t1543.003}
\subsubsection{Weak service permissions}
user \verb+accesschk+ (\verb+ /accepteula -quvcw+) from
sysinternals~\ref{sysinternals} on a service name with \verb+RW+ access it is
possible to modify the bin path with 
\begin{verbatim}
sc config SERVICE  binpath=
\end{verbatim}

\url{https://www.winhelponline.com/blog/view-edit-service-permissions-windows/}

\subsubsection{Writable directory of a service}
check with \verb+icacls+ and replace the binary

\subsubsection{Unquoted service path}

\verb+sc qc+ to query the service and confirm the unqoted path.
or search for unqoted services paths
\begin{verbatim}
wmic service get name,displayname,pathname,startmode |
    findstr /i "auto" | 
    findstr /i /v "c:\windows\\" | 
    findstr /i /v """
\end{verbatim}

\subsubsection{Permissive registry ACLs}
\subsection{Modifiable Registry Autorun Binary}
\begin{verbatim}
Get-CimInstance Win32_StartupCommand | select Name, command, Location, User |fl
\end{verbatim}
\url{https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries}

\url{https://www.microsoftpressstore.com/articles/article.aspx?p=2762082&seqNum=2}
