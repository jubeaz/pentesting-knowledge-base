\section{Query registery (T1012)}
\label{mitre:t1012}

\verb+reg query+


\subsection{SNMP}
\begin{verbatim}
reg query HKLM\SYSTEM\CurrentControlSet\Services\SNMP /s
Get-ChildItem -path HKLM:\SYSTEM\CurrentControlSet\Services\SNMP -Recurse
\end{verbatim}

\subsection{Install elevated}
\begin{itemize}
    \item Always install elevated settings: allow to abuse the 

        \verb+msiexec /i  c:\MSI_PATH /quiet /qn /norestart+
        to launch a \verb+msfvenom+ (\verb+-f msi+) crafted payload.
\begin{verbatim}
HKCU\Software\Policies\Microsoft\Windows\Installer
HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer
\end{verbatim}
    \item UAC:
\begin{verbatim}
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
\end{verbatim}

it might be mecessary to check applocker policy
\begin{verbatim}
Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections
\end{verbatim}


\end{itemize}
