
\section{Account / Group Discovery (T1087 / T1069)}
\label{T1087}

\subsection{Logged in  user}
to get the list of logged in users \verb+query user+ or \verb+qwinsta+


\subsection{Current user}

{\bf cmd}:
\begin{verbatim}
echo %USERNAME%
whoami /priv
whoami /groups
whoami /all
\end{verbatim}

{\bf Powershell}:

\begin{verbatim}
\end{verbatim}

\subsection{Local users}
{\bf cmd}:
\begin{verbatim}
net user
net user NAME
\end{verbatim}

{\bf Powershell}:
\begin{verbatim}
Get-LocalUser | ft Name,Enabled,LastLogon
Get-ChildItem C:\Users -Force | select Name
Get-WmiObject -Class Win32_OperatingSystem | select Description
\end{verbatim}

\subsection{Local groups}
{\bf cmd}:
\begin{verbatim}
net localgroup
net localgroup NAME
\end{verbatim}

{\bf Powershell}:
\begin{verbatim}
Get-LocalGroup | ft Name
Get-LocalGroupMember Administrators | ft Name, PrincipalSource
\end{verbatim}
