\section{System Information Discovery (T1082)}
\label{T1082}

\subsection{Environment variables}
The environment variables explain a lot about the host configuration. To get a printout of them, Windows provides the set command. 

One of the most overlooked variables is \verb+PATH+. A writable folder placed
in the PATH, may lead tp a \emph{DLL Injection}~\ref{t1055.001} attack. When
running a program, Windows looks for that program in the current working
directory first, then from the PATH. 

{\bf cmd}:
\begin{verbatim}
set
\end{verbatim}

{\bf PowerShell}:
\begin{verbatim}
Get-ChildItem Env: | ft Key,Value
\end{verbatim}

\subsection{Configuration information}

command show if the box has been patched recently and if it
is a VM.  The System Boot Time and OS Version can also be checked to get an idea of the
patch level. If the box has not been restarted in over six months, chances are
it is also not being patched.

{\bf cmd}:
\begin{itemize}
    \item \verb+ver+: 
    \item \verb+wmic os get osarchitecture+:  
    \item \verb+systeminfo+: 
\end{itemize}

{\bf PowerShell}:
\begin{itemize}
    \item \verb+Get-ComputerInfo+: 
\end{itemize}


\subsection{Patches and updates}
If systeminfo doesn't display hotfixes, they may be queriable with WMI using
the WMI-Command binary with
\href{https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-quickfixengineering}{QFE
(Quick Fix Engineering)} to display patches.

\href{https://claroty.com/team82/blog/from-kbs-to-cves-understanding-the-relationships-between-windows-security-updates-and-vulnerabilities}{From KBs to CVE}

{\bf cmd}:
\begin{verbatim}
wmic qfe list
\end{verbatim}


We can do this with PowerShell as well using the
\href{https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-hotfix?view=powershell-7.1}{Get-Hotfix} cmdlet.

{\bf PowerShell}:
\begin{verbatim}
Get-HotFix | ft -AutoSize
Get-WmiObject -query 'select * from win32_quickfixengineering'
\end{verbatim}

\subsection{Password policy}

{\bf cmd}:
\begin{verbatim}
net accounts
\end{verbatim}

{\bf Powershell}
\begin{verbatim}
\end{verbatim}

